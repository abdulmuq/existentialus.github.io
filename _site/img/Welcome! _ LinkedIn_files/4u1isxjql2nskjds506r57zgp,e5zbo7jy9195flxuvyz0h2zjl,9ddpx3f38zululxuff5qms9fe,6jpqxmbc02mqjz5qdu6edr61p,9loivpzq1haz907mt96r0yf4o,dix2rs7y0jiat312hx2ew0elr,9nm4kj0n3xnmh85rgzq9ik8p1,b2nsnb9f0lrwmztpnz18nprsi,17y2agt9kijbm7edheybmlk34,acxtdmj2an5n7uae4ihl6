(function(a,b){a("playerjs",b.requires("playerjs"));a("webTrackingTransport",require("liTrackClient"))})(define,LIModules);(function(){var a=LIModules.requires("BaseControl"),d=LIModules.requires("jquery"),f=LIModules.requires("underscore"),g=LIModules.requires("OzTooltip"),a=a.extend(function(a){var b;b={dataAttribute:"li-tooltip-id"};return{beforeDecoration:function(){this._config=f.defaults(this._config,b);this._tooltipList={}},attachEventListeners:function(){this._$el.on("mouseover focus",this._getSelectorString(),this._instantiateTooltip)},_getFullDataAttribute:function(){return"data-"+this._config.dataAttribute},
_getSelectorString:function(){return"["+this._getFullDataAttribute()+"]"},_instantiateTooltip:function(e){var a=e.target,c=d(a).attr(this._getFullDataAttribute()),b;b=jQuery.extend({},this._config,{tooltipContentID:c});c&&!this._tooltipList[c]&&(this._tooltipList[c]=new g(a,b),this._tooltipList[c].isReady.then(function(){d(a).triggerHandler(e.type)}))},detachEventListeners:function(){this._$el.off("mouseover focus",this._getSelectorString(),this._instantiateTooltip)},destroy:function(){this.detachEventListeners();
for(var a in this._tooltipList)this._tooltipList[a].destroy(),delete this._tooltipList[a]}}});LIModules.exports("OzTooltipFactory",a)})();function WebTrack(){function g(a){var b="",c=[],d;if("string"===typeof a)b=a;else if("object"===typeof a){for(d in a)c.push(d+":"+a[d]);b=c.join("|")}return b}this.createRequestData=function(a,b,c,d,f){var e=["pkey\x3d"+escape(LI.getPageKey())];e.push("tcode\x3d"+escape(a));e.push("plist\x3d"+escape(g(b)));"string"===typeof d&&e.push("cId\x3d"+escape(d));"undefined"!==typeof c&&c&&e.push("prefix\x3dfalse");"undefined"!==typeof f&&f&&e.push("evt\x3d"+escape(f));return e.join("\x26")};this.trackUserAction=
function(a,b,c,d,f){WebTracking.saveWebActionTrackURL&&(a=WebTracking.createRequestData(a,b,c,d,f),LI.asyncRequest("POST",WebTracking.saveWebActionTrackURL,{custom:{exception:function(){return!1}},timeout:3E3},a))};this.trackUserImpression=function(a,b,c,d){this.trackUserAction(a,b,c,d,"imp")};this.trackWithCallback=function(a,b,c,d,f,e){WebTracking.saveWebActionTrackURL?(a=this.createRequestData(a,b,f,e),b={custom:{exception:function(){return!1}},timeout:3E3},"undefined"!==typeof c&&null!==c&&(b.success=
c),"undefined"!==typeof d&&null!==d&&(b.failure=d,b.custom.exception=d),LI.asyncRequest("POST",WebTracking.saveWebActionTrackURL,b,a)):c&&c()};this.trackBeforeNavigation=function(a,b,c,d,f){var e;e=function(){window.location.href=b};WebTracking.saveWebActionTrackURL?(a=this.createRequestData(a,c,d,f),e={success:e,failure:e,custom:{exception:function(){return!1}},timeout:3E3},LI.asyncRequest("POST",WebTracking.saveWebActionTrackURL,e,a)):e()}}window.WebTracking=new WebTrack;(function(b,e){if("function"===typeof define&&define.amd)define("VideoTrackingAdaptor",["exports","webTrackingTransport"],e);else if("undefined"!==typeof exports)e(exports,require("webTrackingTransport"));else{var g={};e(g,b.webTrackingTransport);b.VideoTrackingAdaptor=g}})(this,function(b,e){Object.defineProperty(b,"__esModule",{value:!0});var g=function(){function b(c,a){for(var f=0;f<a.length;f++){var d=a[f];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(c,
d.key,d)}}return function(c,a,f){a&&b(c.prototype,a);f&&b(c,f);return c}}(),k=e&&e.__esModule?e:{"default":e},h="mediaUrn length mediaViewTrackingId volume timeElapsed isPlaying".split(" "),l={ENTERED_VIEWPORT:"ENTERED_VIEWPORT",EXITED_VIEWPORT:"EXITED_VIEWPORT",USER_TRIGGERED:"USER_TRIGGERED",VIDEO_PRIORITY_CHANGED:"VIDEO_PRIORITY_CHANGED"};b.PLAYER_PLAY_PAUSE_EVENT="PlayerPlayPauseEvent";b.PLAYER_POSITION_CHANGED_EVENT="PlayerPositionChangedEvent";b.PLAYER_SEEK_EVENT="PlayerSeekEvent";b.PLAYER_VOLUME_CHANGED_EVENT=
"PlayerVolumeChangedEvent";b.PLAYER_QUALITY_EVENT="PlayerQualityEvent";b.PLAYER_FULLSCREEN_EVENT="PlayerFullscreenEvent";b.STATE_FIELDS=h;b.PLAYER_STATE_CHANGED_REASONS=l;var m=function(){function b(c,a,f){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");k["default"].setAppId(c);k["default"].maxQueueSize=3;this._state={};this.requestHeader=a;this.mobileHeader=f}g(b,[{key:"constructPlayerPositionChangedEvent",value:function(c){return{requestHeader:this.requestHeader,
mobileHeader:this.mobileHeader,state:this.state}}},{key:"constructPlayerPlayPauseEvent",value:function(c){var a=this.constructPlayerPositionChangedEvent();if(!l[c])throw Error("The reason for a player change event must be a valid PlayPauseChangedReason enum value.");a.reason=c;return a}},{key:"constructPlayerSeekEvent",value:function(c){var a=this.constructPlayerPositionChangedEvent();a.previousTimeElapsed=c;return a}},{key:"constructPlayerVolumeChangedEvent",value:function(c){var a=this.constructPlayerPositionChangedEvent();
a.previousVolume=c;return a}},{key:"_constructSchema",value:function(c,a){return{eventInfo:{eventName:c,appId:this.appId},eventBody:a}}},{key:"trackPlayerEvent",value:function(c){for(var a=arguments.length,b=Array(1<a?a-1:0),d=1;d<a;d++)b[d-1]=arguments[d];a=this._constructSchema(c,this["construct"+c].apply(this,b));k["default"].track(a)}},{key:"state",set:function(c){for(var a in c)c.hasOwnProperty(a)&&-1<=h.indexOf(a)&&(this._state[a]=c[a])},get:function(){var c=this,a={};h.forEach(function(b){c._state.hasOwnProperty(b)&&
-1<=h.indexOf(b)&&(a[b]=c._state[b])});return a}}]);return b}();b["default"]=m});(function(h,b){if("function"===typeof define&&define.amd)define("PlayerjsTrackingAdaptor",["exports","playerjs","VideoTrackingAdaptor"],b);else if("undefined"!==typeof exports)b(exports,require("playerjs"),require("VideoTrackingAdaptor"));else{var e={};b(e,h.playerjs,h.VideoTrackingAdaptor);h.PlayerjsTrackingAdaptor=e}})(this,function(h,b,e){Object.defineProperty(h,"__esModule",{value:!0});h["default"]=function(c,b){function h(a){d.state={volume:a};a!==m&&d.trackPlayerEvent(e.PLAYER_VOLUME_CHANGED_EVENT,
m);m=a}function u(){c.getMuted(function(a){a?h(0):c.getVolume(function(a){h(a)})})}function q(){k=setInterval(u,3E3);l=setInterval(function(){d.state.isPlaying&&d.trackPlayerEvent(e.PLAYER_POSITION_CHANGED_EVENT)},v)}function n(){k=clearInterval(k);l=clearInterval(l)}var f=this,w=b.mediaViewTrackingId,x=b.mediaUrn,r=b.beaconFrequency,v=void 0===r?3E3:r,s=e.PLAYER_STATE_CHANGED_REASONS.USER_TRIGGERED,t=!1,m=0,p=0,d=new y["default"](b.appId,b.requestHeader,b.mobileRequestHeader),k,l;d.state={mediaUrn:x,
mediaViewTrackingId:w};c.getVolume(function(a){d.state={volume:a}});c.getDuration(function(a){d.state={length:a}});c.getCurrentTime(function(a){d.state={timeElapsed:a}});this.onSeeked=function(a){d.trackPlayerEvent(e.PLAYER_SEEK_EVENT,a)}.bind(this);this.onTimeUpdate=function(a){if("object"===typeof a){a=a.seconds;d.state={timeElapsed:a};if(!t&&3<=Math.abs(a-p))this.onSeeked(p);p=a}}.bind(this);this.onPlay=function(){k&&l||(n(),q());d.state={isPlaying:!0};d.trackPlayerEvent(e.PLAYER_PLAY_PAUSE_EVENT,
f.reason)}.bind(this);this.onPause=function(){d.state={isPlaying:!1};d.trackPlayerEvent(e.PLAYER_PLAY_PAUSE_EVENT,f.reason)}.bind(this);this.onEnded=function(){d.state={isPlaying:!1};n();d.trackPlayerEvent(e.PLAYER_POSITION_CHANGED_EVENT)}.bind(this);this.unbindEvents=function(){c.off(g.TIMEUPDATE,f.onTimeUpdate);c.off(g.PLAY,f.onPlay);c.off(g.PAUSE,f.onPause);c.off(g.ENDED,f.onEnded);c.off(g.SEEKED,f.onSeeked)}.bind(this);this.destroy=function(){n();d=null;f.unbindEvents()}.bind(this);c.on(g.READY,
function(){c.on(g.TIMEUPDATE,f.onTimeUpdate);c.on(g.PLAY,f.onPlay);c.on(g.PAUSE,f.onPause);c.on(g.ENDED,f.onEnded);c.supports("event",g.SEEKED)&&(t=!0,c.on(g.SEEKED,f.onSeeked));q()}.bind(this));Object.defineProperty(this,"reason",{set:function(a){s=a},get:function(){return s}})};b=b&&b.__esModule?b:{"default":b};var y=e&&e.__esModule?e:{"default":e};Object.defineProperty(h,"PLAYER_STATE_CHANGED_REASONS",{enumerable:!0,get:function(){return e.PLAYER_STATE_CHANGED_REASONS}});var g=b["default"].EVENTS});/* Auto generated, hash = 5y4oza2xremuknc717hh5k8nm */
(function(c){var e=c.requires("jquery"),d=c.requires("BaseControl"),f=c.requires("underscore"),g=c.requires("Events"),d=d.extend(function(c){var d={activeClass:"active",eventType:"click",mercyTime:400,triggerSelector:null,dropdownMenuClass:"dropdown",focusClass:null};return{beforeDecoration:function(){this._$body=e("body");this._mouseDown=!1;this._mouseoutTimer=0;this._config=e.extend({},d,this._config);this._isOpen=!1;this._$listItems=[];this._$trigger={};this._$dropMenu={};this._currentItemIndex=
-1;this.isMouseEvent=!1;this._config.triggerSelector?this._$trigger=this._$el.find(this._config.triggerSelector):(this._$trigger=this._$el.children("a"),0===this._$trigger.length&&(this._$trigger=this._$el.children("button")));this._$dropMenu=this._$trigger.next();this._populateListItems();this._bootstrapAria()},attachEventListeners:function(){if("hover"===this._config.eventType)this._$el.on("mouseover",this._handleMouseOverEvent).on("mouseout",this._handleMouseOutEvent);this._$trigger.on("mousedown",
this._handleMousedownEvent).on("click",this._handleClickEvent).on("mouseup",f.bind(this._setMouseUser,this,!0));this._$body.on("click",this._handleBodyClick);this._$el.on("keydown",this._handleKeyEvent);if(this._config.focusClass)this._$el.on("focusin",this._handleElFocusInEvent).on("focusout",this._handleElFocusOutEvent);g.on("dropdown:newitems",this.bootstrapNewItems)},_bootstrapAria:function(){this._$trigger.attr({tabindex:0,"aria-haspopup":!0,role:"button"});this._bootstrapListItems();this._$dropMenu.attr("tabindex",
-1);this._$listItems.length&&this._$dropMenu.attr("role","menu")},_bootstrapListItems:function(){this._$listItems.each(function(){e(this).attr({tabindex:0,role:"menuitem"})})},bootstrapNewItems:function(a){this._populateListItems();this._bootstrapListItems()},_setMouseUser:function(a){this.isMouseEvent=a},_populateListItems:function(){this._$listItems=this._$dropMenu.find("li, dd, dt")},_handleBodyClick:function(a){this._isOpen&&0===this._$el.has(a.target).length&&(this._setMouseUser(!0),this.close())},
_focusNext:function(){var a=this._$listItems.length;a&&(this._currentItemIndex<a-1?this._currentItemIndex++:this._currentItemIndex=0,this._$listItems[this._currentItemIndex].focus())},_focusPrevious:function(){var a=this._$listItems.length;a&&(0<this._currentItemIndex?this._currentItemIndex--:this._currentItemIndex=a-1,this._$listItems[this._currentItemIndex].focus())},_handleKeyEvent:function(a){var b=a.target;switch(a.which){case 13:e(b).is(this._$trigger)&&this._$trigger.click();break;case 32:e(b).is(this._$trigger)&&
(a.preventDefault(),this._$trigger.click());break;case 27:this._isOpen&&this.close();break;case 40:a.preventDefault();this._focusNext();break;case 38:a.preventDefault(),this._focusPrevious()}},open:function(){var a=this._config.activeClass;this._isOpen||(this._$el.addClass(a),this.isMouseEvent||this._$dropMenu.focus(),this._$el.trigger("dropdown:open",this),this._isOpen=!0)},close:function(){this._isOpen&&(this._$el.removeClass(this._config.activeClass),this._mouseoutTimer&&window.clearTimeout(this._mouseoutTimer),
this.isMouseEvent||this._$trigger.focus(),this._$el.trigger("dropdown:close",this),this._isOpen=!1,this._currentItemIndex=-1,this._setMouseUser(!1))},_handleMousedownEvent:function(a){this._mouseDown=!0},_handleElFocusInEvent:function(a){this._$el.addClass(this._config.focusClass)},_handleElFocusOutEvent:function(a){this._$el.removeClass(this._config.focusClass)},_handleClickEvent:function(a){var b;this._mouseDown=!1;if("hover"===this._config.eventType&&(b=a.target.href)&&0!==b.indexOf("#"))return;
a.preventDefault();a.stopPropagation();this._isOpen?this.close():this.open()},_handleMouseOverEvent:function(a){this._setMouseUser(!0);window.clearTimeout(this._mouseoutTimer);this.open()},_handleMouseOutEvent:function(a){a=this._config.mercyTime;var b=this;0<a?this._mouseoutTimer=window.setTimeout(function(){b.close()},a):b.close()}}});d.EVENTS={OPEN:"dropdown:open",CLOSE:"dropdown:close",NEW:"dropdown:newitems"};c.exports("Dropdown",d)})(window.LIModules);
(function(){var e=LIModules.requires("jquery"),d=function(b){var a,c,d,f={};b.closest(".feed-update").find(".list-item-entity").each(function(b){a=e(this);c=a.data("id");d=a.find(".rank-container").data("rank");f["trendingMember-id-at-position-"+b]=c;f["trendingMember-rank-at-position-"+b]=d});b.closest("[data-li-utrk-el]").attr("data-li-utrk-custom",JSON.stringify(f))},g={feedRoutes:{"member-post-name":{u:"actorName",n:"viewMemberProfile"},"member-name":{u:"actorName",n:"viewMemberProfile"},"member-mention-name":{u:"atMention",
n:"viewMemberProfile"},"member-info-name":{u:"objectName",n:"viewMemberProfile"},"member-info-title":{u:"objectName",n:"viewMemberProfile"},"member-post-title":{u:"actorName",n:"viewMemberProfile"},"member-connected-with-name":{u:"xConnectionName",n:"viewMemberProfile"},"member-connect-name":{u:"yConnectionName",n:"viewMemberProfile"},"member-connect-image":{u:"yConnectionPhoto",n:"viewMemberProfile"},"member-connect-title":{u:"yConnectionName",n:"viewMemberProfile"},"member-connect-member-image":{u:"objectPhoto",
n:"viewMemberProfile"},"member-pymk-name":{u:"pymkName",n:"viewMemberProfile"},"member-pymk-title":{u:"pymkName",n:"viewMemberProfile"},"member-pymk-image":{u:"pymkPhoto",n:"viewMemberProfile"},"member-commenter-name":{u:"belowFeedCommenterName",n:"viewMemberProfile"},"member-commenter-image":{u:"belowFeedCommenterPhoto",n:"viewMemberProfile"},"followed-name":{u:"followedName",n:"viewMemberProfile"},"followed-title":{u:"objectName",n:"viewMemberProfile"},"member-post-image":{u:"scanPhoto",n:"viewMemberProfile"},
"member-facepile-image":{u:"facepilePhoto",n:"viewMemberProfile"},"member-image":{u:"scanPhoto",n:"viewMemberProfile"},"member-followed-image":{u:"followedPhoto",n:"viewMemberProfile"},"member-new-profile-image":{u:"newProfilePhoto",n:"viewMemberProfile"},"member-new-background-photo":{u:"newBackgroundPhoto",n:"viewMemberProfile"},"member-new-background-photo-update-trigger":{u:"newBackgroundPhotoUpdateTrigger",n:"viewMemberProfile"},"influencer-logo":{u:"influencerLogo",n:"viewMemberProfile"},"author-name":{u:"belowViralFeedSharerName",
n:"viewMemberProfile"},"member-author-name":{u:"belowViralFeedSharerName",n:"viewMemberProfile"},"member-author-image":{u:"belowViralFeedSharerPhoto",n:"viewMemberProfile"},"company-author-image":{u:"belowViralFeedSharerPhoto",n:"viewCompanyPage"},"school-author-image":{u:"belowViralFeedSharerPhoto",n:"viewSchoolPage"},"member-author-title":{u:"belowViralFeedSharerName",n:"viewMemberProfile"},"member-influencer-image":{u:"followeePhoto",n:"viewMemberProfile"},"member-influencer-name":{u:"followeeName",
n:"viewMemberProfile"},"member-influencer-title":{u:"followeeName",n:"viewMemberProfile"},"influencer-dismiss-rec":{y:"DISMISS",u:"peopleDismiss",n:"dismissRec"},"see-more-influencers":{y:"EXPAND",u:"showMoreCTA",n:"showMore"},"member-reshare-article-name":{u:"actorName",n:"viewMemberProfile"},"company-reshare-article-name":{u:"actorName",n:"viewCompanyPage"},"school-reshare-article-name":{u:"actorName",n:"viewSchoolPage"},"reshare-article-via-member-name":{u:"reshareViaMemberName",n:"viewMemberProfile"},
"reshare-article-via-company-name":{u:"reshareViaCompanyName",n:"viewCompanyPage"},"reshare-article-via-school-name":{u:"reshareViaSchoolName",n:"viewSchoolPage"},"reshare-article-via-channel-name":{u:"reshareViaChannelName",n:"viewChannelPage"},"company-post-image":{u:"scanPhoto",n:"viewCompanyPage"},"company-facepile-image":{u:"facepilePhoto",n:"viewCompanyPage"},"company-image":{u:"companyPhoto",n:"viewCompanyPage"},"company-rec-image":{u:"scanPhoto",n:"viewCompanyFollowing"},"company-follow-image":{u:"companyPhoto",
n:"viewCompanyPage"},"company-post-name":{u:"actorName",n:"viewCompanyPage"},"company-name":{u:"companyName",n:"viewCompanyPage"},"company-mention-name":{u:"atMention",n:"viewCompanyPage"},"company-industry":{u:"companyName",n:"viewCompanyPage"},"group-name":{u:"groupName",n:"viewGroup"},"group-image":{u:"groupPhoto",n:"viewGroup"},"group-discussion-title":{u:"groupDiscussionName",n:"viewGroupDiscussion"},"job-name":{u:"jobName",n:"viewJobPage"},"job-image":{u:"scanPhoto",n:"viewJobsPage"},"job-location":{u:"jobLocation",
n:"viewCareersPage"},"company-jymbii-image":{u:"companyPhoto",n:"viewJobPage"},"channel-post-name":{u:"channelName",n:"viewChannelPage"},"channel-name":{u:"channelName",n:"viewChannelPage"},"channel-post-image":{u:"scanPhoto",n:"viewChannelPage"},"channel-image":{u:"channelPhoto",n:"viewChannelPage"},"school-post-name":{u:"schoolName",n:"viewSchoolPage"},"school-author-name":{u:"belowViralFeedSharerName",n:"viewSchoolPage"},"school-card-name":{u:"schoolName",n:"viewBoardItem"},"school-name":{u:"schoolName",
n:"viewSchoolPage"},"school-post-image":{u:"scanPhoto",n:"viewSchoolPage"},"school-card-image":{u:"schoolPhoto",n:"viewBoardItem"},"school-image":{u:"schoolPhoto",n:"viewSchoolPage"},"decision-board-name":{u:"decisionBoardName",n:"viewBoard"},"decision-board-image":{u:"decisionBoardPhoto",n:"viewBoard"},"fos-name":{u:"fieldOfStudyName",n:"viewFOSPage"},"fos-card-name":{u:"fieldOfStudyName",n:"viewBoardItem"},"fos-image":{u:"fieldOfStudyPhoto",n:"viewFOSPage"},"fos-card-image":{u:"fieldOfStudyPhoto",
n:"viewBoardItem"},"work-job-name":{u:"workJobName",n:"viewMemberProfile"},"pulse-logo":{u:"pulseLogo",n:"viewPulse"},"pulse-name":{u:"pulseHeadline",n:"viewPulse"},"pymk-connect-image":{u:"scanPhoto",n:"viewConnectHub"},"premium-how-you-rank-update-image":{u:"seeHYRCTA",n:"viewHYR",custom:d},"premium-how-you-rank-image":{u:"recommendedEntity",n:"viewMemberProfile",custom:d},"premium-how-you-rank-title":{u:"recommendedEntity",n:"viewMemberProfile",custom:d},"premium-how-you-rank-recent-activity":{u:"seeRecentActivity",
n:"viewMemberRecentActivity",custom:d},"premium-how-you-rank-cta":{u:"seeHYRCTA",n:"viewHYR",custom:d},"premium-how-you-rank":{u:"seeHYRCTA",n:"viewHYR",custom:d},"premium-how-you-rank-name":{u:"recommendedEntity",n:"viewMemberProfile",custom:d},"premium-insights-update-image":{u:"recommendedEntity",n:"viewJob"},"premium-insights-headline":{u:"mentionedEntity",n:"viewJob"},"company-premium-insights-job-image":{u:"recommendedEntity",n:"viewJob"},"premium-insights-job-position":{u:"recommendedEntity",
n:"viewJob"},"premium-insights-view-job-cta":{u:"recommendedEntity",n:"viewJob"},"premium-insights-chart":{u:"recommendedEntity",n:"viewJob"},"article-title":{u:"articleTitle",n:"viewArticle"},"article-image":{u:"articlePhoto",n:"viewArticle"},"rich-media-image":{u:"richMediaObject",n:"viewRichMedia"},"video-title":{y:"PLAY",u:"videoTitle",n:"clickVideo"},"video-image":{y:"PLAY",u:"videoImage",n:"clickVideo"},"video-thumbnail-image":{y:"PLAY",u:"videoThumbnail",n:"clickVideo"},"video-player":{y:"PLAY",
u:"videoPlayInViewport",n:"autoPlayVideo"},"show-previous-comments":{y:"EXPAND",u:"belowFeedPreviousCommentsCTA",n:"expandComments"},"likes-social-summary":{y:"EXPAND",u:"belowFeedLikerIcon",n:"expandLikers"},"comments-social-summary":{y:"EXPAND",u:"belowFeedCommenterIcon",n:"expandCommenters"},"shares-social-summary":{y:"EXPAND",u:"otherSharers",n:"expandLikers",condition:function(b,a){return b[0]===a[0]}},link:{u:"sharedURL",n:"viewLink"},"show-more-text":{u:"belowFeedShowMore",n:"expandText"},
"show-less-text":{u:"belowFeedShowLess",n:"collapseText"},like:{y:"LIKE",u:"belowFeedLikeCTA",n:"likeUpdate"},"pulse-like":{y:"LIKE",u:"belowPulseLikeCTA",n:"likeArticle"},"viral-like":{y:"LIKE",u:"belowViralFeedLikeCTA",n:"likeUpdate"},unlike:{y:"UNLIKE",u:"belowFeedUnlikeCTA",n:"unlikeUpdate"},"pulse-unlike":{y:"UNLIKE",u:"belowPulseUnlikeCTA",n:"unlikeArticle"},"viral-unlike":{y:"UNLIKE",u:"belowViralFeedUnlikeCTA",n:"unlikeUpdate"},comment:{y:"EXPAND",u:"belowFeedCommentCTA",n:"expandComment"},
"pulse-comment":{y:"EXPAND",u:"belowPulseCommentCTA",n:"expandComment"},"viral-comment":{y:"EXPAND",u:"belowViralFeedCommentCTA",n:"expandComment"},"comment-submit":{y:"COMMENT",u:"belowFeedCommentSubmitCTA",n:"submitComment",condition:function(b){return!b.prop("disabled")},custom:function(b){var a=b.closest(".comment-box").find(".mentions-input"),c=LIModules.imports("ozFeed"),a=(a=c&&c.mentions.getInstance(a))&&a.generateMentions(),a='{"numMentions":'+(a&&a.length||0)+"}";b.closest("[data-li-utrk-el]").attr("data-li-utrk-custom",
a)}},"pulse-comment-submit":{y:"COMMENT",u:"belowPulseCommentSubmitCTA",n:"submitComment",condition:function(b){return!b.prop("disabled")},custom:function(b){var a=b.closest(".comment-box").find(".mentions-input"),c=LIModules.imports("ozFeed"),a=(a=c&&c.mentions.getInstance(a))&&a.generateMentions(),a='{"numMentions":'+(a&&a.length||0)+"}";b.closest("[data-li-utrk-el]").attr("data-li-utrk-custom",a)}},share:{y:"EXPAND",u:"belowFeedShareCTA",n:"expandShare"},"pulse-share":{y:"EXPAND",u:"belowPulseShareCTA",
n:"shareArticle"},sendConnectInvite:{y:"CONNECT",u:"connectCTA",n:"connectMember"},"send-message":{y:"CLICK",u:"belowFeedMessageCTA",n:"messageMember"},connectRedirect:{y:"CLICK",u:"connectCTA",n:"viewConnectHub"},"company-follow":{y:"FOLLOW",u:"followCTA",n:"followCompany"},"company-dismiss-rec":{y:"DISMISS",u:"companyDismiss",n:"dismissRec"},"channel-follow":{y:"FOLLOW",u:"followCTA",n:"followChannel"},"people-follow":{y:"FOLLOW",u:"followCTA",n:"followMember"},"school-follow":{y:"FOLLOW",u:"followCTA",
n:"followSchool"},"join-group":{y:"JOIN",u:"joinCTA",n:"joinGroup"},"save-job":{y:"SAVE",u:"saveJobCTA",n:"saveJob"},"show-more-updates":{y:"EXPAND",u:"showMoreCTA",n:"showMore"},"show-others":{y:"EXPAND",u:"otherSharers",n:"expandLikers"},"see-more-jobs":{u:"seeMoreCTA",n:"viewJobsPage"},"post-a-job":{u:"seeMoreCTA",n:"postAJobPage"},"post-a-job-alternative":{u:"seeMoreCTA",n:"postAJobPage"},"see-more-news":{u:"showMoreCTA",n:"viewPulse"},"see-more-companies":{y:"EXPAND",u:"showMoreCTA",n:"showMore"},
"see-more-cards":{u:"seeMoreCTA",n:"viewDecisionBoard"},"see-all-updates":{u:"seeAllUpdatesCTA",n:"viewHomepage"},"see-recent-activity":{u:"identityRecentActivity",n:"viewRecentActivity"},"find-more-people":{u:"seeMoreCTA",n:"viewConnectHub"},"view-board":{u:"viewBoardCTA",n:"viewBoard"},"view-channel":{u:"viewChannelCTA",n:"viewChannelPage"},"view-item":{u:"viewItemCTA",n:"viewBoardItem"},"view-job":{u:"viewJobCTA",n:"viewJobPage"},"view-profile":{u:"viewProfileCTA",n:"viewMemberProfile"},"view-post":{u:"viewPostCTA",
n:"viewBoardDiscussion"},"view-on-board":{u:"viewOnBoardCTA",n:"viewDecisionBoard"},"view-company":{u:"viewCompanyCTA",n:"viewCompanyPage"},"see-posts":{u:"seePostsCTA",n:"viewMemberProfile"},"hide-update":{u:"hideCTA",n:"hideUpdate"},"hide-updates-from":{u:"hideCTA",n:"hideUpdatesFrom"},"unfollow-update":{u:"unfollowCTA",n:"unfollowActor"},"wrong-actor-button":{y:"CLICK",u:"wrongActorCTA",n:"reportWrongActor"},"promo-gta-icon":{u:"scanPhoto",n:"viewMobile"},"promo-gta-sms":{u:"getTheAppCTA",n:"sendSMS"},
"promo-gta-dismiss":{y:"DISMISS",u:"dismissCTA",n:"dismissWidget"},"promo-abook-icon":{u:"scanPhoto",n:"viewConnectHub"},"promo-abook-continue":{u:"continueCTA",n:"openABI"},"promo-abook-dismiss":{y:"DISMISS",u:"dismissCTA",n:"dismissRec"},"promo-remktg":{y:"CONTINUE",u:"wyloCTA",n:"continueWYLO"},"promo-abook-nux-dismiss":{y:"DISMISS",u:"dismissCTA",n:"dismissWidget"},"promo-end-icon":{u:"scanPhoto",n:"viewMemberProfile"},"promo-end-name":{u:"actorName",n:"viewMemberProfile"},"promo-end-photo":{u:"actorPhoto",
n:"viewMemberProfile"},"promo-end-endorse":{u:"endorseCTA",n:"endorseMember"},"promo-end-dismiss-card":{y:"DISMISS",u:"dismissCTA",n:"dismissRec"},"promo-end-dismiss-widget":{y:"DISMISS",u:"dismissCTA",n:"dismissWidget"},"promo-end-show":{u:"showMoreCTA",n:"showMore"},"flag-hide-comment":{y:"HIDE",u:"flagAndHideCTA",n:"flagAndHideComment"},"unflag-unhide-comment":{y:"UNHIDE",u:"unflagOrUnhideCTA",n:"unflagOrUnhideComment"},"scin-debug":{u:"scinDebugCTA",n:"scinDebug"},"mini-profile-view-profile":{y:"CLICK",
u:"miniProfile",n:"viewMemberProfile"},"mini-profile-connect":{y:"CONNECT",u:"miniProfile",n:"connectMember"},"mini-profile-follow":{y:"FOLLOW",u:"miniProfile",n:"followMember"},"mini-profile-send-message":{y:"CLICK ",u:"miniProfile",n:"messageMember"},"mini-profile-influencer-logo":{y:"CLICK ",u:"miniProfile",n:"influencerLogo"}},_track:function(b){var a=e(b.currentTarget),c=e(b.target),d=this.feedRoutes[a.data("trk")];b=["","l","m","r"][b.which];d?this._route(a,c,d,b):console.error("data-trk '"+
a.data("trk")+"' does not exist in feedRoutes.")},_route:function(b,a,c,d){var f=c.condition||function(){return!0},g=c.custom||e.noop;c=_.extend({y:"CLICK"},_.pick(c,"y","u","n"));f(b,a)&&(g(b,a),this._triggerClickTracking(b,e.param(c,!0),d))},_triggerClickTracking:function(b,a,c){this.tracker||(this.tracker=LIModules.requires("UserActivityTrackingInstance"));this.tracker.triggerClickTracking(a,this.tracker.getImpressionElement(b),b,c)},init:function(){e("body").on("mouseup","[data-trk]",_.bind(this._track,
this))},track:function(b,a,c){a=a||b.data("trk");(a=this.feedRoutes[a])?this._route(b,b,a,c||""):console.error("data-trk '"+$currentTargetEl.data("trk")+"' does not exist in feedRoutes.")}};e(function(){g.init()});LIModules.exports("OzFeedTrackingRouter",g)})();
(function(){var c=LIModules.requires("jquery"),e=LIModules.requires("underscore"),f=LIModules.requires("MultilineTruncation"),b={truncateAllSnippets:function(a){a=a&&a.length?a:c("#ozfeed");a.find("[data-snippet-headline-truncation]").each(function(){var a,b=c(this),d="30";a=b.parent(".snippet-link").find(".snippet");a.length&&(20>=this.offsetHeight&&(d="45"),a.attr("data-multiline-truncation-height",d),f.truncate(a[0]),a.removeAttr("data-multiline-truncation-height"));b.removeAttr("data-snippet-headline-truncation")})}};
c(function(){e.defer(b.truncateAllSnippets)});LIModules.exports("OzSnippetTruncation",b)})();
(function(){var c=LIModules.requires("jquery"),d=LIModules.requires("underscore"),k=LIModules.requires("Events"),n=LIModules.requires("UserActivityTrackingInstance"),r=LIModules.requires("OzSnippetTruncation"),p,v=LIModules.requires("OzHelpers"),w=LIModules.requires("Mentions"),m=LIModules.imports("TrackFailure"),x=LIModules.requires("OzTooltipFactory"),s=LIModules.imports("ViewportTracking"),q="scroll.ozfeed-infinitePagination",t="data-src",u=c(window),e=function(a){e.log("instantiate OzFeed");this.model=
new Backbone.Model.extend({});this.$el=a;this._updates={};this._$updatesList=a.find(".feed.updates");this._$inViewport=c();this._prevScrollTop=0;this._$loader=a.children(".loader").hide();this._fetchingMoreUpdates=!1;this._nextUpdatesUrl=this._$updatesList.data("pagination-url");this._memberData=this._$updatesList.data("member");this._infinitePaginationModuleKey=this.$el.attr("data-infinite-scroll-module-key");this._shareInjectModuleKey=this.$el.attr("data-inject-module-key");this._moduleKey=this.$el.attr("data-li-utrk-module");
this._preRender();this._bind();d.defer(e.Util.truncateAll,a);d.defer(d.bind(this._onScroll,this));this._loadPartials();this._tooltipCounter=0;this._tooltips={};this._enableTrackingPixels(this.$el);e.log("OzFeed instantiated")};e.prototype={_bind:function(){k.on("ozfeed-newUpdates",d.bind(this._handleNewUpdates,this));p=LIModules.requires("OzFeedUpdate");p.prototype.bindBlockEvents.call(this);this._bindScrollEvents();this._nextUpdatesUrl?this._bindInfinitePagination():this._handleFeedEnd();this._bindShareboxInjection();
this._bindMentions()},_handleNewUpdates:function(a){var b=a.newUpdates;e.Util.truncateAll(b);r.truncateAllSnippets(b);this._enableTrackingPixels(b);n.fireImpressionEvents(this.$el,a.moduleKey||null);s&&s.trackFeedImpressions({fullRefresh:!0});this._onScroll()},_getUpdate:function(a){a=a.closest('li[data-update\x3d"true"]');var b=a.data("update-id"),b=this._updates[b];!b&&a.length&&(b=new p(a),this._updates[b.id]=b);return b},_onScroll:function(){var a=this._$updatesList.find(".feed-update"),b=this._$newUpdatesList,
c=u.scrollTop();this._impressUpdates(a.filter('[data-shown\x3d"false"]'));this._triggerViewportEvents(a.add(b).find("[data-viewport-trackable]"),c-this._prevScrollTop);this._prevScrollTop=c},_impressUpdates:function(a){a.each(function(){var a=c(this);e.Util.isInViewport(a)&&(a.removeAttr("data-shown"),k.fire("update-impression.feed"))})},_triggerViewportEvents:function(a,b){function l(a,c){return a.trigger({type:c,distance:b})}var f=this._$inViewport;if(a.length||f.length){var g=a.not(f),h=a.filter(function(){var a=
c(this),b=a.data("viewport-trackable");return e.Util.isInViewport(a,v.getCssDimensions(b))}),d=a.not(h),g=h.filter(g),d=d.filter(f),f=f.not(d);l(g,"enterviewport");l(d,"exitviewport");l(f,"scrollviewport");this._$inViewport=f.add(g)}},_enableTrackingPixels:function(a){function b(){f.attr("src",function(){var a=c(this),b=f.closest("li.feed-update"),b=n.getElementPosition(b),a=play.addQueryParameter(a.attr(t),"pos",b.row);d&&(a=play.addQueryParameter(a,"abp",window.abp.enabled.toString()));return a});
f.removeAttr(t)}var d=!!document.querySelector("meta[name\x3ddetectAdBlock]"),f=a.find("img.tracking[data-src]");f.error(function(a){a="imgSrc: "+a.target.src+"\nupdateId: "+c(a.target).closest("[data-update-id]").attr("data-update-id");m&&m.logError("TrackingPixelLoadFailure",a)});f.length&&(d&&!window.abp?window.addEventListener("abp:ready",b):b())},_loadPartials:function(){this._$tooltipContainer=c('\x3cdiv class\x3d"tooltip-container"\x3e\x3c/div\x3e');this._$dialogContainer=c('\x3cdiv class\x3d"dialog-container"/\x3e');
this.$el.append(this._$tooltipContainer).append(this._$dialogContainer)},_bindScrollEvents:function(){u.on("scroll",d.throttle(d.bind(this._onScroll,this),100))},_bindMentions:function(){this.mentions=new w.Delegator(this.$el,{mentionsTL:"common-templates/mentions-play"})},_bindInfinitePagination:function(){c(window).on(q,d.throttle(d.bind(this._handleInfinitePagination,this),100))},_handleInfinitePagination:function(){var a=c(window);!this._fetchingMoreUpdates&&a.scrollTop()+a.height()>=c(document).height()-
1E3&&this._fetchMoreUpdates()},_handleFeedEnd:function(){function a(){this._$loader.hide();this.$el.append(this._$endOfFeed);c(window).off(q)}var b=c("#ozfeed.no-activities").length;this._$endOfFeed||b?a.call(this):dust.render("ozfeed-templates/partials/end-of-feed/_no-more-updates",{},d.bind(function(b,d){this._$endOfFeed=c(d);a.call(this)},this))},_insertNewUpdates:function(a){dust.render("ozfeed-templates/partials/_updates",a,d.bind(function(b,d){this.insertUpdatesAfter(c(d),this._infinitePaginationModuleKey);
a.paginationUrl?this._nextUpdatesUrl=a.paginationUrl:(this._handleFeedEnd(),this._markEndOfFeed());this._fetchingMoreUpdates=!1},this))},_markEndOfFeed:function(){c("#isEndOfFeed").val("true")},insertShareboxUpdates:function(a){dust.render("ozfeed-templates/partials/_updates",a,d.bind(function(a,d){this.insertUpdatesBefore(c(d),this._shareInjectModuleKey)},this))},_fetchMoreUpdates:function(){this._fetchingMoreUpdates=!0;this._$loader.show();e.Util.ajax({url:this._nextUpdatesUrl,timeout:null,context:this,
success:this._insertNewUpdates,error:function(a,b,e){var f=new c.Deferred,g,h;"timeout"===b?(g="InfiniteScrollTimeout",h="Infinite Scroll AJAX request timed out."):"error"===b&&(g="InfiniteScrollException",h="Infinite Scroll AJAX error. Status code: "+a.status+" "+a.statusText+". Error message: "+e+".");m&&(g&&h)&&m.logError(g,h);this._$feedError?f.resolve():dust.render("ozfeed-templates/partials/end-of-feed/_feed-error-try-again",{url:this._nextUpdatesUrl},d.bind(function(a,b){this._$feedError=c(b);
this._$feedError.find(".try-again").click(d.bind(function(){this._$loader.show();this._$feedError.detach();this._fetchMoreUpdates();this._bindInfinitePagination()},this));f.resolve()},this));f.done(d.bind(function(){this._fetchingMoreUpdates=!1;this.$el.append(this._$feedError);this._$loader.hide();c(window).off(q)},this))}}).done(this.storePages)},_preRender:function(){var a=c("#refreshForm"),b=c("#isRecentFilter"),e=c("#isEndOfFeed");c("button[data-filter\x3d'top']");var f=c("button[data-filter\x3d'recent']"),
g=this;a.find("input").each(function(){var a=c(this);a.val()&&(g._fetchingMoreUpdates=!0,g._insertNewUpdates(JSON.parse(a.val())),n.fireImpressionEvents())});"true"==b.val()&&c(window).load(function(){d.defer(function(){f.click()})});"true"!=e.val()||"true"==b.val()?this._bindInfinitePagination():g._fetchingMoreUpdates=!0},storePages:function(a){c("#refreshForm input[value\x3d'']").first().val(JSON.stringify(a))},_bindShareboxInjection:function(){k.on("postmodule.submit",d.bind(this._handleShareboxInjection,
this))},_handleShareboxInjection:function(a){e.Util.ajax({url:"/hp/modules/ozfeed/item",type:"GET",data:{activityId:a.activityId},context:this,success:this.insertShareboxUpdates,error:function(){a.tries=(a.tries||0)+1;30>=a.tries&&d.delay(d.bind(this._handleShareboxInjection,this),2E3,a)}}).done(this.storeShareboxPages)},storeShareboxPages:function(a){a.insertUpdateType="sharebox";c("#realtimeRefreshForm input[value\x3d'']").first().val(JSON.stringify(a))},replaceFeed:function(a){var b=this._updates,
l;for(l in b)b[l].destroy();this._updates={};this._nextUpdatesUrl=a.paginationUrl;dust.render("ozfeed-templates/updates",a,d.bind(function(a,b){var d=c(b),l=d.children(),m=this.$el;this._$updatesList=d;m.find(".updates").remove();m.prepend(this._$updatesList);this._$endOfFeed&&this._$endOfFeed.detach();this._$feedError&&this._$feedError.detach();e.Util.truncateAll(d);r.truncateAllSnippets(d);k.trigger("ozfeed-newUpdates",{newUpdates:l,moduleKey:this._moduleKey});this._bindInfinitePagination()},this))},
insertUpdatesBefore:function(a,b){var l;this.$el.find(".promo.updates").length&&!this._$newUpdatesList&&(this._$newUpdatesList=c(this._$updatesList[0].cloneNode(!1)),this.$el.prepend(this._$newUpdatesList));l=this._$newUpdatesList||this._$updatesList;a.addClass("highlighted");l.prepend(a);d.delay(function(){a.addClass("seen")},20);k.trigger(e.OZFEED_NEW_UPDATES_EVENT,{newUpdates:a,moduleKey:b})},insertUpdatesAfter:function(a,b){this._$loader.hide();this._$updatesList.append(a);k.trigger("ozfeed-newUpdates",
{newUpdates:a,moduleKey:b});k.trigger("infinitePagination-newPage")},getMemberData:function(a){return a?this._memberData[a]:this._memberData},addTooltipFactory:function(a){var b=d.defaults({delayOpen:10,delayClose:100,dependencies:[]},a.jsConfig);this._tooltips[a.type]=new x(document.body,b)},addTooltips:function(a){var b=this,e=a.dataAttribute,f=a.type;a.$el.each(function(){var a=c(this),h,k;a.data("tooltip-exists")||(a.data("tooltip-exists",!0),h=a.attr(e),k=b._tooltipCounter++,h=h+"-"+k,a.attr(e,
h),a.attr("aria-describedby",h),dust.render("ozfeed-templates/partials/_"+f,{id:k},d.bind(function(a,b){var d=c(b);this._$tooltipContainer.append(d)},b)))})},addDialog:function(a){this._$dialogContainer.html(a)}};e.log=function(a){e.debug&&console.log("-- OzFeed log: "+a)};e.OZFEED_NEW_UPDATES_EVENT="ozfeed-newUpdates";e.ENTER_VIEWPORT_EVENT="enterviewport";e.EXIT_VIEWPORT_EVENT="exitviewport";e.SCROLL_VIEWPORT_EVENT="scrollviewport";e.HIGHLIGHTED="highlighted";c(function(){var a=c(window);LIModules.exports("ozFeed",
new e(c("#ozfeed")));a.load(function(){a.scroll()})});(function(){c(window).on("load",function(){c("img[data-delayed-url]").each(function(){var a=c(this);a.attr("src",a.attr("data-delayed-url"));a.removeAttr("data-delayed-url")})})})();LIModules.exports("OzFeed",e)})();
(function(){var f=LIModules.requires("jquery"),l=LIModules.requires("underscore");LIModules.requires("fiber");var g=LIModules.requires("OzFeed"),h=LIModules.requires("OzHelpers"),p=LIModules.requires("ModalDialogBox"),q=LIModules.requires("t8");g.Util={_i18nResources:new q.Resources(dust.i18n,dust),ajax:h.ajax,truncate:function(a,b,c){var d=b.length>c;return{text:d?a.truncate({length:c}).html():b,truncated:d}},truncateAll:function(a){a.find("[data-truncate]").each(function(){var a=f(this),c=a.find("p"),
d=c.html(),e=g.Util.truncate(c,c.text(),a.data("truncate"));e.truncated&&(e=e.text,a.data("full-text",d),a.data("truncated-text",e),c.html(e),a.addClass("shortened"),dust.render("ozfeed-templates/partials/_show-more-less",{},function(a,b){c.append(b)}));a.removeAttr("data-truncate");a.data("truncate",null)})},isInViewport:function(a,b){var c=f(window),d=a.offset(),e=c.scrollTop(),m=c.scrollLeft(),k;b=l.defaults(b||{},{top:0,bottom:0,left:0,right:0});k=m+c.width();c=e+c.height();d.right=d.left+a.outerWidth();
d.bottom=d.top+a.outerHeight();return!(k<d.left-b.right||m>d.right+b.right||c<d.top+b.top||e>d.bottom-b.bottom)},getCsrfToken:function(){this.csrfToken||(this.csrfToken=play.getPageContextValue("csrfToken",!0));return this.csrfToken},addCsrfToken:function(a){return play.addQueryParameter(a,"csrfToken",this.getCsrfToken())},getTransitionEndEvent:h.getTransitionEndEvent,setupTransition:h.setupTransition,setupDialog:function(a){var b=a.$el,c=a.titleKey,d=a.jsConfig||{},e=a.hasOwnProperty("openAfterInit")?
a.openAfterInit:!0,m=l.extend({id:a.id},a.data),k=new f.Deferred,g=new f.Deferred,h,n;a.ajaxDialog?k.resolve():(h=a.template,n=a.render||f.noop,dust.render(h,m,l.bind(function(a,b){n(a,b);LIModules.requires("ozFeed").addDialog(b);k.resolve()},this)));this._i18nResources.get(c,"ozfeed-templates/partials/_i18n",{},function(a,b){g.resolve(b)});return f.when(g.promise(),k.promise()).done(l.bind(function(c){a.ajaxDialog||b.data("href","#"+m.id);d.title=c;c=new p(b,d);b.data("dialog",c).prop("dialog",c);
e&&b.data("dialog").isReady.done(function(){b.data("dialog").open()});f.isFunction(a.done)&&a.done()},this))},embed:{HTTPS_UNSUPPORTED_PROVIDERS:["cnbc"],withEmbedly:function(a,b){return f.getJSON("//api.embed.ly/1/oembed?"+f.param({key:"b8949c0eb73c11e089614040d3dc5c07",url:a,width:Math.floor(b),autoplay:!0,secure:0<=location.protocol.indexOf("https")})+(0<=location.href.indexOf("mock-set")?"":"\x26callback\x3d?"))},isEmbeddable:function(a){var b=0===location.href.indexOf("https"),c=document.createElement("a");
c.href=a;a=l.every(g.Util.embed.HTTPS_UNSUPPORTED_PROVIDERS,function(a){return-1===c.hostname.indexOf(a)});return!b||a}}}})();
(function(){var g=LIModules.requires("jquery"),c=LIModules.requires("underscore"),q=LIModules.requires("Backbone"),f=LIModules.requires("OzFeed"),k,r=LIModules.requires("OzHelpers"),p=q.Model.extend({}),m=["click","mousedown","keydown","keyup","keypress","focusin","focusout","submit","paste","cut",f.ENTER_VIEWPORT_EVENT,f.EXIT_VIEWPORT_EVENT,f.SCROLL_VIEWPORT_EVENT],h=function(a,b){k=LIModules.imports("ozFeed");var d=a.data("update-id")||h.blockIdCounter++,e;f.log("instantiate new update, id \x3d "+
d);this.$el=a;this.id=d;this.actorType=a.data("actor-type");this._deleteUrl=a.data("delete-url");this.views={};this.model=new p;a.data("update-id",d);for(e in h.views)this.initView(a.find('[data-block\x3d"'+e+'"]'));this.model.set("state","shown");b&&(this.bindBlockEvents(),this._getUpdate=function(){return this})};h.prototype={_removeUpdate:function(a){f.log("shrinking update");r.transitionToClass(this.$el,this.model.get("state"),a)},_renderWrongEntityMessage:function(){dust.render("ozfeed-templates/partials/_wrong-entity-update",
{},c.bind(function(a,b){var d=g(b);this._$notice=d;this.$el.before(d);this.$el.detach();this._$closeAction||(this._$closeAction=d.find(".close"));this._addCloseTooltip();this._bindCloseNotice()},this))},_renderHideMessage:function(a,b){function d(){this.$el.before(this._$notice);this.$el.detach()}var e;this._$notice?d.call(this):(e=new g.Deferred,b?dust.render("ozfeed-templates/partials/_hidden-update-activity",{url:this.undoUrl,fromActor:a,actorType:this.actorType},c.bind(function(a,b){this._$notice=
g(b);d.call(this);e.resolve()},this)):dust.render("ozfeed-templates/partials/_hidden-update",{url:this.undoUrl,fromActor:a,actorType:this.actorType},c.bind(function(a,b){this._$notice=g(b);d.call(this);e.resolve()},this)),e.done(c.bind(function(){var a=this._$notice;this._$closeAction||(this._$closeAction=a.find(".close"));this._$undoAction||(this._$undoAction=a.find(".undo"));this._addCloseTooltip();this._bindUndoAction();this._bindCloseNotice()},this)))},_renderUnfollowMessage:function(a,b){var d;
this._$notice?(this.$el.before(this._$notice),this.$el.detach()):(d=new g.Deferred,dust.render("ozfeed-templates/partials/_unfollow-update",{url:this.undoUrl,fromActor:a,actorType:this.actorType,actorName:b},c.bind(function(a,b){this._$notice=g(b);this.$el.before(this._$notice);this.$el.detach();d.resolve()},this)),d.done(c.bind(function(){var a=this._$notice;this._$closeAction||(this._$closeAction=a.find(".close"));this._$undoAction||(this._$undoAction=a.find(".undo"));this._addCloseTooltip();this._bindUndoAction();
this._bindCloseNotice()},this)))},_renderDeleteMessage:function(){var a;this._$notice?this.$el.replaceWith(this._$notice):(a=new g.Deferred,dust.render("ozfeed-templates/partials/_deleted-update",{},c.bind(function(b,d){this._$notice=g(d);this.$el.replaceWith(this._$notice);a.resolve()},this)),a.done(c.bind(function(){this._$closeAction||(this._$closeAction=this._$notice.find(".close"));this._addCloseTooltip();this._bindCloseNotice()},this)))},_renderUpdate:function(){var a=this.$el,b=this.model;
this._$notice.after(a);this._$notice.detach();a.removeClass(b.get("state"));b.set("state","shown")},_addCloseTooltip:function(){k.addTooltips({$el:this._$closeAction,dataAttribute:"data-close-tooltip-id",type:"close-tooltip"})},_bindCloseNotice:function(){this._$closeAction.on("click",c.bind(this._handleCloseNotice,this))},_handleCloseNotice:function(){var a=this._$notice;f.log("dismissing deleted update notice");this._$closeAction.blur();a.addClass("closing");f.Util.setupTransition({$el:a,eventCallback:c.bind(function(b){"opacity"===
b.originalEvent.propertyName&&a.remove()},this)})},_bindUndoAction:function(){this._$undoAction.on("click",c.bind(this._handleUndoAction,this))},_handleUndoAction:function(){f.Util.ajax({url:this.undoUrl,type:"POST"});this._renderUpdate()},bindBlockEvents:function(){var a=this.$el,b=c.bind(function(a){var b=g(a.target),c=a.type,s=this._getUpdate(b),b=b.closest("[data-block]"),l=h.views[b.data("block")];(c=b.length&&l&&l.events&&-1!==m.indexOf(c)&&l.events[c])&&c.call(s.views[b.data("block-id")],a)},
this);a.on(m.join(" "),b)},getViews:function(a,b){var d=this.views,e=[],g={ancestor:"update",firstBlock:!0},h,l,n,f,k;for(h in d)l=d[h],l.block===a&&e.push(l);b&&(b=c.defaults(b,g),n=b.ancestor,f=b.$context,k=b.firstBlock,e=c.filter(e,function(a){var b=!0,d=f.closest('[data-block\x3d"'+n+'"]');k?(a=a.$el.parent().closest("[data-block]"),b=a.data("block")===n):a=a.$el.closest('[data-block\x3d"'+n+'"]');return b&&d[0]==a[0]}));return e},initView:function(a,b){var d=this,e=[];a.each(function(){var a=
g(this),b,c,f,m;a.closest('[data-update\x3d"true"]')[0]===d.$el[0]&&(b=a.data("block"),m=(c=h.views[b])&&c.sync&&k._updates[d.id]&&(f=k._updates[d.id].getViews(b))&&f[0]&&f[0].model||new p,f=function(){this.id=h.blockIdCounter++;this.block=b;this.model=m;this.update=d;this.$el=a;this.removeSelf=function(){this.$el.remove();delete this.update.views[this.id]}},c&&(f.prototype=c.methods,c=new f,a.data("block-id",c.id),c.init&&c.init(),d.views[c.id]=c,e.push(c)))});b&&(e=c.filter(e,function(a){return a.block===
b}));return e},replaceAndBind:function(a,b){var d=this.views[a].$el,e=g(b);e.data("block-id",d.data("block-id"));d.hide().before(e);this.views[a].$el=e;c.delay(c.bind(d.remove,d),0)},dismissSelf:function(a){this.model.set("state","dismissing");this._removeUpdate(a)},deleteSelf:function(a){this.model.set("state","deleting");this._removeUpdate(c.bind(a||this._renderDeleteMessage,this))},wrongEntity:function(a){this.model.set("state","hiding");this._removeUpdate(c.bind(this._renderWrongEntityMessage,
this,a))},hideSelf:function(a,b,d){this.undoUrl||(this.undoUrl=a);this.model.set("state","hiding");this._removeUpdate(c.bind(this._renderHideMessage,this,b,d))},hideSelfForUnfollow:function(a,b,d){debugger;this.undoUrl||(this.undoUrl=a);this.model.set("state","hiding");this._removeUpdate(c.bind(this._renderUnfollowMessage,this,b,d))},append:function(a){this.$el.children(".content").append(a)},destroy:function(){var a=this.views,b,d;for(b in a)d=a[b],d.model.destroy(),c.isFunction(d.destroy)&&d.destroy()}};
h.views={};h.blockIdCounter=0;h.addView=function(a){this.views[a.block]=a};h.renderUpdate=function(a){var b=new g.Deferred;dust.render("ozfeed-templates/partials/_standalone-update",a,c.bind(function(a,c){b.resolve(c)},this));return b};g(function(){c.defer(function(){k=LIModules.requires("ozFeed");k.addTooltipFactory({type:"close-tooltip",jsConfig:{direction:"top",tooltipContentID:"close-tooltip",dataAttribute:"close-tooltip-id"}})})});LIModules.exports("OzFeedUpdate",h)})();
(function(){var e=LIModules.requires("jquery"),h=LIModules.requires("underscore"),g=LIModules.requires("Events"),n=LIModules.requires("Mentions"),f=LIModules.requires("ModalDialogBox"),k=LIModules.requires("OzFeed"),m=["ozfeed-comment-box-render","ozfeed-comment-list-render","ozfeed-text-entity-render"],f=f.extend(function(f){return{setDialogBodyContent:function(b){var a=this._$dialog;b=e(b).hide();var c;this._$dialogBody=c=a.find(".dialog-body");this._$spinner||(this._$spinner=a.find(".spinner").detach());
a.css({width:a.width(),height:a.height(),overflow:"hidden"});this._$spinner.css("height",c.height());k.Util.truncateAll(b);c.html(this._$spinner.add(b));a.addClass("loaded");this._$commentPane=c.find(".rmv-comment-pane");this._$section=this._$commentPane.find(".rmv-section");this._fitToWindow();h.each(m,function(a){g.off(a)});g.on(m.join(" "),h.bind(function(){this._fitToWindow(!0)},this));e("#ozfeed").data("rmv-mentions")&&this._bindMentions()},_bindMentions:function(){var b=this,a=e("#ozfeed").data("oon-mentions");
this.mentions=new n.Delegator(this._$dialogBody.find(".rich-media-viewer")[0],{oonMentions:a,mentionsTL:"common-templates/mentions-play"});e(".mentions-typeahead").on("typeahead:opened",function(){b._$dialogBody.css("overflow","visible")}).on("typeahead:closed",function(){b._$dialogBody.css("overflow","auto")})},_getPosition:function(){var b=e(window),a=this._config.top,c=b.innerWidth()/2-(this._rendered?this.dialogWidth:this._config.width)/2+this._config.xOffset;this._config.centerVertically&&(a=
b.innerHeight()/3-(this._rendered?this.dialogHeight:this._$dialog.outerHeight())/3+this._config.yOffset,a=Math.max(a,this._config.top));return{left:c,top:a}},_adjustGhostDimensions:function(){var b=e(window).innerWidth()-50,a=this._$dialog.find(".dialog-title").outerHeight(),a=e(window).innerHeight()-this._config.top-50-a,c=this._$ghostDialog.find(".shared-image img"),d;d=c.height();var f=c.width();d>a&&(d=f/d*a,c.height(a),c.width(d));this._$ghostDialog.width()>b&&this._$ghostDialog.width(b)},_adjustWidth:function(){var b=
this._$ghostDialog.width();this.dialogWidth&&this.dialogWidth===b||(this.dialogWidth=b);this._$dialog.width(this.dialogWidth).find(".rich-media-viewer").css("opacity",1)},_adjustHeight:function(b){var a=this._$dialog,c=this._$dialogBody,d=this._$section,f=this._$commentPane,h=a.find(".dialog-title").outerHeight(),l=e(window).innerHeight()-this._config.top-50-h,g=this._$ghostDialogBody.innerHeight(),k=c.innerHeight();this.commentBoxHeight=c.find(".comment-box").outerHeight();this.scrollableHeight=
this._$ghostDialogBody.find(".scrollable").css("max-height","none").height()||d.height();b=g>l?b&&l>k&&l<g?k:l:g;b<=this.scrollableHeight+this.commentBoxHeight?(f.addClass("comment-box-fixed"),d.height(b-this.commentBoxHeight)):(f.removeClass("comment-box-fixed"),d.height("auto"));d=b+h;c.innerHeight(b);a.height(d);this.dialogHeight=d},_fitToWindow:function(b){var a,c;this._$ghostDialog=a=this._$dialog.clone().css({top:0,left:0,visibility:"hidden",width:"auto",height:"auto"});this._$ghostDialog.find(".rich-media-viewer").show();
this._$ghostDialog.find(".spinner").remove();this._$ghostDialogBody=a.find(".dialog-body").height("auto");c=a.find(".rmv-preview-pane img");e("body").append(a);c.length?c.load(h.bind(function(){this._$dialogBody.find(".rich-media-viewer").show();this._$spinner.detach();this._adjustGhostDimensions();this._adjustWidth();this._adjustHeight(b);this._$dialog.css(this._getPosition()).css("overflow","visible");g.trigger(k.OZFEED_NEW_UPDATES_EVENT,{newUpdates:this._$dialogBody});a.remove()},this)).error(function(){a.remove()}):
a.remove()}}});LIModules.exports("OzFeedRichMediaViewer",f)})();
(function(){var d=LIModules.requires("jquery"),b=LIModules.requires("underscore"),f=LIModules.requires("Events"),h=LIModules.requires("OzFeed"),l=LIModules.requires("UserActivityTrackingInstance"),k=function(a){this._$el=a;this._$action=a.find(".chiclet");this._$feed=d("#ozfeed");this._$updatesList=this._$feed.find(".feed.updates");this._fetchUrl=a.data("fetch-url");this._pollingIntervalValues=a.data("polling-interval-values");this._pollUrl=this._pollingIntervalValues.realTimePollUrl;this._pollingTimeInterval=
this._pollingIntervalValues.realTimePollingInterval;this._updatesCountThreshold=this._pollingIntervalValues.countThreshold;this._moduleKey=a.attr("data-li-utrk-module");this._useDynamicPolling=a.data("use-dynamic-polling");this._realTimeInterval=null;this._fetchingUpdates=!1;this._lastScrollPosition=0;this._offsetTop=a.offset().top;this._fixedTransitionPosition=this._offsetTop-(this.GLOBAL_NAV_HEADER_HEIGHT+this.GLOBAL_NAV_MENU_HEIGHT+this.GLOBAL_NAV_SPACING);this._numCalls=this._lastPollCount=0;
this._preRenderRealtime();this._bindGlobalNavEvents();this._bindRealTimeInjection();this._setupRealTimePolling();f.on(this.STOP_EVENT,b.bind(function(){this._updateWindowTitle();this._clearRealTimePolling()},this));f.on(this.START_EVENT,b.bind(function(a){a&&(this._pollUrl=a);this._setupRealTimePolling()},this));f.on(this.DISMISS_EVENT,b.bind(this._dismissChiclet,this))};k.prototype={REAL_TIME_INTERVAL:2E4,MAX_POLLING_INTERVAL:18E5,MAX_UPDATES:20,SCROLL_EVENT:"scroll.ozfeed-realTimeUpdates",SCROLL_THROTTLE_DELAY:1E3/
60,STOP_EVENT:"realTimeUpdates.stop",START_EVENT:"realTimeUpdates.start",DISMISS_EVENT:"realTimeUpdates.dismiss",GLOBAL_NAV_HEADER_HEIGHT:42,GLOBAL_NAV_MENU_HEIGHT:29,GLOBAL_NAV_SPACING:10,SCROLL_TOP_ANIMATION_TIME:500,_setupRealTimePolling:function(){if(this._pollUrl){var a=this.REAL_TIME_INTERVAL;this._useDynamicPolling&&"control"===this._pollingTimeInterval&&(a=Math.min(1E3*Math.pow(1.3,this._numCalls)+this.REAL_TIME_INTERVAL*(this._numCalls+1),this.MAX_POLLING_INTERVAL),a=isNaN(a)?this.MAX_POLLING_INTERVAL:
a);"control"!==this._pollingTimeInterval&&(a=1E3*this._pollingTimeInterval);this._realTimeInterval=setInterval(b.bind(function(){h.Util.ajax({url:this._pollUrl,success:b.bind(this._pollSuccess,this),error:d.noop})},this),a)}},_preRenderRealtime:function(){var a=this;d("#realtimeRefreshForm").find("input").each(function(){var c=d(this);c.val()&&(this._fetchingMoreUpdates=!0,c=JSON.parse(c.val()),"realtime"===c.insertUpdateType?a._injectRealTimeUpdates(c):LIModules.requires("ozFeed").insertShareboxUpdates(c),
l.fireImpressionEvents())})},_pollSuccess:function(a){var c=a.count,g=a.elementTrk,e=c>this._lastPollCount;this._numCalls++;e&&c>=this._updatesCountThreshold?(this._lastPollCount=c,this._clearRealTimePolling(),c>this.MAX_UPDATES?c=this.MAX_UPDATES+"+":this._setupRealTimePolling(),this._updateWindowTitle(c),dust.render("ozfeed-templates/partials/_real-time-updates",{count:c,elementTrk:g,realTimeModuleKey:this._moduleKey},b.bind(function(a,c){var g=d(c);g.attr("class",this._$el.attr("class"));this._$el.replaceWith(g);
this._$el=g;this._$action=this._$el.find(".chiclet");this._bindRealTimeInjection();b.delay(b.bind(function(){this._updateChiclet();this._showChiclet()},this),20);d(window).off(this.SCROLL_EVENT);d(window).on(this.SCROLL_EVENT,b.throttle(b.bind(this._updateChiclet,this),this.SCROLL_THROTTLE_DELAY))},this))):(this._clearRealTimePolling(),this._setupRealTimePolling());this._fetchUrl=a.realTimeFetchUrl},_updateWindowTitle:function(a){var c=d("title"),b=c.text(),e=c.data("original");e||(c.data("original",
b),e=b);b=e;a&&(b="("+a+") "+e);c.text(b)},_updateChiclet:function(){var a=d(window).scrollTop();0<this._lastScrollPosition&&a>this._lastScrollPosition?this._hideChiclet():a<this._lastScrollPosition&&this._showChiclet();this._$el.toggleClass("fixed",a>this._fixedTransitionPosition);this._lastScrollPosition=a},_showChiclet:function(){this._$el.hasClass("visible")||(this._$action.prop("disabled",!1),this._$el.addClass("visible"),this._$el.attr("data-li-utrk-impr",""),l.fireImpressionEvents())},_hideChiclet:function(){this._$el.removeClass("visible")},
_dismissChiclet:function(){this._$action.prop("disabled",!0);d(window).off(this.SCROLL_EVENT);this._lastPollCount=this._lastScrollPosition=0;this._hideChiclet()},_animateToTop:function(){var a=d(window).scrollTop();0<a&&d("body, html").animate({scrollTop:0},1E3>a?this.SCROLL_TOP_ANIMATION_TIME/2:this.SCROLL_TOP_ANIMATION_TIME)},_bindRealTimeInjection:function(){this._$el.on("click",b.bind(this._handleRealTimeInjection,this))},_bindGlobalNavEvents:function(){"fixed"===d("#responsive-nav-scrollable").css("position")&&
this._handleGlobalNavHide();f.on("globalnav:showStart",b.bind(this._handleGlobalNavShow,this));f.on("globalnav:hideStart",b.bind(this._handleGlobalNavHide,this))},_handleGlobalNavShow:function(){this._$el.addClass("global-nav-showing");this._fixedTransitionPosition=this._offsetTop-(this.GLOBAL_NAV_HEADER_HEIGHT+this.GLOBAL_NAV_MENU_HEIGHT+this.GLOBAL_NAV_SPACING)},_handleGlobalNavHide:function(){this._$el.removeClass("global-nav-showing");this._fixedTransitionPosition=this._offsetTop-(this.GLOBAL_NAV_HEADER_HEIGHT+
this.GLOBAL_NAV_SPACING)},_handleRealTimeInjection:function(){this._numCalls=0;if(parseInt(this._$el.find(".count").html(),10)===this.MAX_UPDATES)return window.location.reload();this._fetchingUpdates||(this._fetchingUpdates=!0,this._animateToTop(),this._updateWindowTitle(),this._clearRealTimePolling(),this._dismissChiclet(),h.Util.ajax({url:this._fetchUrl,success:b.bind(this._injectRealTimeUpdates,this),error:function(){h.log("real-time fetch failure")}}).done(this.storeRealtimePages))},storeRealtimePages:function(a){a.insertUpdateType=
"realtime";d("#realtimeRefreshForm input[value\x3d'']").first().val(JSON.stringify(a))},_injectRealTimeUpdates:function(a){h.log("real-time fetch success");dust.render("ozfeed-templates/partials/_updates",a.feedData,b.bind(function(a,b){LIModules.requires("ozFeed").insertUpdatesBefore(d(b),this._$el.attr("data-li-utrk-module"))},this));this._pollUrl=a.realTimePollUrl;this._realTimeInterval||this._setupRealTimePolling();this._fetchingUpdates=!1},_clearRealTimePolling:function(){clearInterval(this._realTimeInterval);
this._realTimeInterval=null}};d(function(){d(window).load(function(){var a=d("#real-time-updates");0<a.length&&LIModules.exports("ozFeedRealTimeUpdates",new k(a))})});LIModules.exports("OzFeedRealTimeUpdates",k)})();
(function(){var a=LIModules.requires("jquery"),f=LIModules.requires("underscore"),k=LIModules.requires("Dropdown"),h=LIModules.requires("Events"),m=LIModules.requires("OzFeed"),l=LIModules.requires("UserActivityTrackingInstance"),e=function(b){this._$el=b;this._$feed=a("#ozfeed");this.filterChanging=!1;b.addClass("initialized");this._bindFilterChanging();new k(b.find(".dropdown"),{triggerSelector:".filters-trigger",eventType:"hover"})};e.prototype={_bindFilterChanging:function(){this._$el.on("click",
".filter",f.bind(this._filterClicked,this))},_filterClicked:function(b){var g=this._$el.find(".selected").eq(0),c=a(b.target);b=a("#refreshForm");var d=a("#realtimeRefreshForm");b.find("input").val("");d.find("input").val("");c.hasClass("selected")||this.filterChanging||(this.filterChanging=!0,g.removeClass("selected"),c.addClass("selected").removeAttr("data-li-utrk-impr_fired").attr("data-li-utrk-impr",""),l.fireImpressionEvents(this._$feed),this.revert=f.once(f.bind(function(){g.addClass("selected");
c.removeClass("selected");this._handleFilterChanging(g.data("url"),g.data("filter"))},this)),this._handleFilterChanging(c.data("url"),c.data("filter")))},_handleFilterChanging:function(b,g){var c=LIModules.requires("ozFeed"),d=LIModules.imports("ozFeedRealTimeUpdates"),f=a('\x3cdiv class\x3d"overlay switching-filters"/\x3e'),e=this._$feed.find(".updates").find(".feed-update \x3e .content"),k=e.children(".image"),l=a("#isRecentFilter"),n=a("button[data-filter\x3d'recent']");d?(h.trigger(d.STOP_EVENT),
h.trigger(d.DISMISS_EVENT),e.add(k).addClass("switching-filters").prepend(f),m.Util.ajax({url:b,context:this}).done(function(a){c.replaceFeed(a.updates);l.val(n.hasClass("selected"));h.trigger(d.START_EVENT,a.updates.realTimePollUrl)}).fail(function(){a(".overlay.switching-filters").remove();a(".switching-filters").removeClass("switching-filters");this.revert();h.trigger(d.START_EVENT)}).always(function(){this.filterChanging=!1})):(this.revert(),this.filterChanging=!1)},revert:function(){}};a(function(){LIModules.exports("ozFeedFilters",
new e(a("#filters")))});LIModules.exports("OzFeedFilters",e)})();
(function(){function k(){var b=a(this);b.parents(c).removeClass(d);(2>this.naturalHeight||2>this.naturalWidth)&&b.triggerHandler("error")}function e(){a(this).parents(c).addClass(d)}function f(){a("#ozfeed").find(l).addClass(g).filter(function(){var b=a(this).attr("src")===m;b&&e.call(this);return!b}).on("load"+h,k).on("error"+h,e).each(function(){this.complete&&a(this).load()})}var a=LIModules.requires("jquery"),n=LIModules.requires("underscore"),p=LIModules.requires("Events"),q=LIModules.requires("OzFeed"),
m=play.assetUrl("images/ozfeed/side_stock_grey_bg.png"),g="checked",c=".side-article",l=".side-content-image img:not(."+g+")",d="img-load-error",h=".oz-feed-images";a(function(){n.defer(f)});p.on(q.OZFEED_NEW_UPDATES_EVENT,f)})();
(function(){var b=LIModules.requires("jquery"),m=/(\s*\S+|\s)$/;b.fn.truncate=function(h){var d=b.extend({},b.fn.truncate.defaults,h);return this.each(function(h,n){var k=b(n),c=k.text(),a=c.length-d.length;if(0<a){var l=c.length-c.slice(0,d.length).replace(m,"").length;(c.length-l)/c.length>d.minLengthThreshold&&(a=l-1)}0>a||!a&&!d.truncated||b.each(k.contents().get().reverse(),function(c,f){var g=b(f),e=g.text().length;if(e<=a)d.truncated=!0,a-=e,g.remove();else{if(3===f.nodeType)return b(f.splitText(e-
a-1)).remove(),!1;g.truncate({length:e-a});return!1}})})};b.fn.truncate.defaults={minLengthThreshold:0.5}})();
(function(){var a=LIModules.requires("jquery"),d=LIModules.requires("fs"),g=LIModules.requires("Events"),h=LIModules.requires("OzFeed"),k=LIModules.requires("play"),c;a(function(){function l(b,a){var e=b.attr("data-url");b.data("abi-nux")&&c&&(e=k.addQueryParameter(e,"initCallback","abkFetchFormCallback"),window.abkFetchFormCallback=function(a){a.addSubscribers({importerSuccess:function(){c.coolOffGroup("uno-takeover","default","main","abook-group","time\x3e\x3d30d")}})});d.reset();d.embedXHR(a,{url:e,
container:a});d.after(a,function(a,d){var c=b.find("#resolve-btn");c.prop("disabled",!0);c.attr({"data-li-lego-action":"PRIMARY_ACTION","data-li-lego-action-name":"continue","data-trk":"promo-abook-continue","data-li-lego-sync":"true"})})}function f(){a("#hp-feed-abk-social-form-container, #hp-feed-abk-nux-form-container").filter(function(){return!a(this).data("initialized")}).each(function(){var b=a(this);b.data("initialized",!0);l(b,b.attr("id"))})}c=LIModules.imports("PlayLego");f();g.on(h.OZFEED_NEW_UPDATES_EVENT,
f)})})();
(function(){LIModules.requires("OzFeedUpdate").addView({block:"actions",methods:{insertAfter:function(a){this.$el.after(a)}}})})();
(function(){var c=LIModules.requires("jquery"),a=LIModules.requires("underscore"),b=LIModules.requires("OzFeedUpdate"),f=LIModules.requires("OzFeed");b.addView({block:"aggregated-shares-list",methods:{init:function(){this.$loader=c('\x3cdiv class\x3d"loading hidden"\x3e\x3c/div\x3e');this.$list=this.$el.find(".shares");this.$el.prepend(this.$loader);this._resetBuffer();this.model.on("change:pendingShares",this.render,this)},render:function(){dust.render("ozfeed-templates/partials/_inserted-aggregated-shares",
this.model.get("pendingShares"),a.bind(function(k,d){var b=this.$list,e=c(d),g=this.$el,h=this.$loader;b.prepend(d);f.Util.truncateAll(e);a.delay(function(){h.addClass("hidden");g.removeClass("inserting waiting")},20);this.update.initView(e.find("[data-block]"));this._resetBuffer()},this))},_resetBuffer:function(){this.model.set("pendingShares",{},{silent:!0})},triggerLoading:function(){this.$el.addClass("inserting");a.delay(a.bind(function(){this.$loader.removeClass("hidden");this.$el.addClass("waiting")},
this),16)},insertShares:function(a){this.model.set("pendingShares",a)}}})})();
(function(){LIModules.requires("jquery");var c=LIModules.requires("underscore"),e=LIModules.requires("OzFeedUpdate"),d=LIModules.requires("OzFeedTrackingRouter"),a=LIModules.requires("OzFeed"),f={"not-connected":"inline-connect","invitation-sent":"invitation-sent"};e.addView({block:"connect",events:{click:function(){a.log("clicked on connect");this._connect()}},methods:{init:function(){var b=this.model;this.url=this.$el.data("url");b.set("state","not-connected");b.on("change:state",this.render,this)},
render:function(){dust.render("ozfeed-templates/blocks/actions/connect/"+f[this.model.get("state")],{},c.bind(function(b,a){this.$el.replaceWith(a);this.model.off("change:state")},this))},_connect:function(){a.Util.ajax({url:this.url,type:"POST",success:c.bind(function(b){a.log("ajax call succeeded");if("email"===b.status){if(b=this.$el.data("email-url"))d.track(this.$el,"connectRedirect"),window.location.href=b}else d.track(this.$el,"sendConnectInvite"),this.model.set("state","invitation-sent");
this.update.getViews("recommendation-entity",{ancestor:"recommendation-entity",$context:this.$el})},this),error:function(){a.log("ajax failed");a.log("error handler has not been implemented yet")}})}}})})();
(function(){function q(a,b){var c=d(b);this.$el.before(c);this.commentList=this.update.initView(c)[0]}function r(a){var b=this.$el.find(f);b.length||(b=d('\x3cdiv class\x3d"'+f.substr(1)+'" /\x3e'),this.$el.prepend(b));this.$el.find(f).empty();dust.render(a.template,{},function(c,e){c||(b.html(e),_.isFunction(a.callback)&&a.callback())})}function h(){this.$el.find(g).removeAttr("disabled")}function s(){this.$el.find(g).is(".for-review")&&this.render({buttonDisabled:!0})}function t(a,b){var c=this.postParams,
e=/urn:li:discussion:(\d+):group:(\d+)/;c.objectUrn&&e.test(c.objectUrn)?(e=c.objectUrn.match(e),_.extend(c,{commentId:"",item:e[1],type:"member",gid:e[2],abbreviated:!0,ajax:!0,csrfToken:k.Util.getCsrfToken(),ItemCommentParam:a})):c.articleId?_.extend(c,{commentBody:a,mentions:b}):_.extend(c,{message:a,mentions:b});return k.Util.ajax({url:this.baseUrl,data:c}).then(function(a,b,c){a="object"===typeof a?a:{status:"ERROR"};a.content?(b=a.content.objectUrn||a.content.commentWithActor||a.content.commentID,
a.success=!!b):a.success=!!a.commentID;a.status="ok"===a.status?"SUCCESS":a.status;a.status="fail"===a.status?"ERROR":a.status;a.statusCode&&(a.status="0"===a.statusCode?"SUCCESS":a.statusCode);a.content&&(a.content.pulseComment&&"success"==a.content.status)&&(a.success=!0);return a.success?a:d.Deferred().reject(a,c).promise()}).fail(_.bind(function(a){var b={block:{template:"common-templates/error-messages/content-blocked",callback:_.bind(s,this)},review:{template:"common-templates/error-messages/content-to-be-reviewed",
callback:_.bind(h,this)},reviewPremoderated:{template:"common-templates/error-messages/content-to-be-reviewed-premoderated",callback:_.bind(h,this)},error:{template:"common-templates/error-messages/generic",callback:_.bind(h,this)}};r.call(this,b[a.isPremoderated?"reviewPremoderated":a.status]||b.error)},this))}function n(){this._validate();l.trigger(this.newCharacterEvent)}function p(){_.defer(_.bind(n,this))}function u(){this._reset()}function v(){m||(m=!0,setTimeout(function(){m=!1},50),this._resize())}
var d=LIModules.requires("jquery"),l=LIModules.requires("Events"),k=LIModules.requires("OzFeed"),f=".error-message-container",g=".comment-submit",m=!1;LIModules.requires("OzFeedUpdate").addView({block:"comment-box",events:{focusin:function(a){d(a.target).is("textarea")&&!this.expanded&&this._expand()},keyup:_.throttle(n,1E3),paste:p,cut:p,submit:function(a){a.preventDefault();this._validate()&&this._submit()}},methods:{init:function(){var a=this.$el;this.baseUrl=a.data("base-url");this.postParams=
a.data("post-params");this.type=this.$el.data("type");this.trk="pulse"===this.type?"pulse-comment-submit":"comment-submit";this.$textarea=a.find("textarea");this.$mentions=a.find("input[name\x3dmentions]");this.startHeight=this.$textarea.outerHeight();this.expandedHeight=this.startHeight+17;this.scrollHeight=this.startHeight;this.textareaVPadding=parseInt(this.$textarea.css("padding-top"),10)+parseInt(this.$textarea.css("padding-bottom"),10);this.textareaMaxHeight=parseInt(this.$textarea.css("max-height"),
10);this.newCharacterEvent="new-characters-"+this.id;this.isOverMaxCharLimit=!1;this.$textarea.on("scroll",_.bind(v,this)).on("blur",_.bind(u,this));l.on(this.newCharacterEvent,_.throttle(_.bind(this._resize,this),100))},focus:function(){this.$el.show();this.$textarea.focus()},render:function(a){var b=this.$el.find("button");a=_.defaults(a||{},{showButton:!0,trk:b.attr("data-trk")||this.trk,autoTrk:b.attr("data-li-auto-click-utrki")});dust.render("ozfeed-templates/partials/_comment-box-message-and-button",
a,_.bind(function(a,b){var d=this.$el,f=d.find(".comment-box-partial");f.length?f.replaceWith(b):d.append(b)},this))},_expand:function(){var a=this.$el,b=this.$textarea;this.expanded||(this.$mirror||(this.$mirror=d("\x3cpre/\x3e",{"class":"mirror","aria-hidden":!0,css:{width:b.width()}}),a.prepend(this.$mirror)),this.commentList||(this.commentList=this.update.getViews("comment-list")[0]),this.render({showButton:!1,buttonDisabled:!0}),b.addClass("trans"),_.defer(_.bind(function(){this._setupTransition();
a.find(".button-container").addClass("show");b.css("height",this.expandedHeight)},this)),this.expanded=!0)},_reset:function(){this.$textarea.val().length||(this._validate(),this.$el.find(f).empty())},_resize:function(){var a=this.$textarea,b;this.scrollHeight=a[0].scrollHeight;_.defer(_.bind(function(){this.$mirror.text(a.val()+"\x26nbsp;");b=this.$mirror.height();b>this.expandedHeight&&b<this.scrollHeight?this.scrollHeight=Math.min(this.textareaMaxHeight,b+this.textareaVPadding):b<this.expandedHeight&&
(this.scrollHeight=this.expandedHeight);this.scrollHeight!==a.innerHeight()&&(this._setupTransition(),a.css("height",this.scrollHeight))},this))},_setupTransition:function(){k.Util.setupTransition({$el:this.$textarea}).done(function(){_.delay(l.trigger,10,"ozfeed-comment-box-render")})},_submit:function(){var a=this.$textarea.attr("disabled","disabled"),b=a.val().replace(/\r\n?/g,"\n"),c=this.$mentions.val(),e=this.$el.find(g).addClass("submitting").attr("disabled","disabled");t.call(this,b,c).done(_.bind(function(){this.commentList||
dust.render("ozfeed-templates/blocks/comment-list",{},_.bind(q,this));this.commentList.addMyComment(b,c?d.parseJSON(c):"");a.val("").trigger("change");this.$mirror.text("");e.is(".for-review")&&this.render({buttonDisabled:!0})},this)).always(_.bind(function(){e.removeClass("submitting");a.removeAttr("disabled");_.defer(_.bind(this._reset,this))},this))},_validate:function(){var a=d.trim(this.$textarea.val()).length;1250<a?(this.isOverMaxCharLimit=!0,this.render({charsLeft:a-1250,buttonDisabled:!0})):
this.isOverMaxCharLimit?(this.isOverMaxCharLimit=!1,this.render({buttonDisabled:!1})):this.$el.find(g).attr("disabled",function(){return 0===a});return 0<a&&1250>=a}}})})($,LI,dust);
(function(){function e(a){var c=a+"Comments";a+="Offset";var b=this.update.getViews("comments-social-summary")[0],d=this.update.getViews("show-previous-comments")[0];b[c]();b[a]();if(d)d[a]()}var f=LIModules.requires("jquery"),b=LIModules.requires("underscore"),g=LIModules.requires("OzFeed"),h=LIModules.requires("OzHelpers");LIModules.requires("OzFeedUpdate").addView({block:"comment-entity",methods:{init:function(){this.model.on("change:state",this.render,this)},render:function(){var a=this.$el;a.addClass("removing");
g.Util.setupTransition({$el:a,eventCallback:b.bind(function(a){"min-height"===a.originalEvent.propertyName&&(this.removeSelf(),this.update.getViews("comment-list")[0].checkIfEmpty())},this)});b.defer(function(){a.addClass("delete")})},toggleHover:function(a){var c=this.$el;c.toggleClass("hover",a);a?c.mouseleave(b.bind(function(){this.deleteComment||(this.deleteComment=this.update.getViews("delete-comment",{ancestor:"comment-entity",$context:c})[0]);this.deleteComment&&this.deleteComment.closeTooltip();
this.flagHideComment||(this.flagHideComment=this.update.getViews("flag-hide-comment",{ancestor:"comment-entity",$context:c})[0]);this.flagHideComment&&this.flagHideComment.closeTooltip();c.removeClass("hover")},this)):c.off("mouseleave")},addDeleteAction:function(a){a=a.content;this.deleteComment||(a="/hp/modules/action-endpoints/deleteComment/"+a.objectUrn+"/"+a.commentID,dust.render("ozfeed-templates/blocks/comment-actions/delete-comment",{url:g.Util.addCsrfToken(a)},b.bind(function(a,b){var d=
f(b),k=this.$el;k.append(d);this.deleteComment=this.update.initView(d);k.addClass("deletable")},this)))},deleteSelf:function(){this.model.set("state","deleted");e.call(this,"decrement")},hide:function(a,c){this.$el.addClass("hidden");e.call(this,"decrement");this.$hiddenComment||dust.render("ozfeed-templates/partials/_hidden-comment",{undoUrl:c},b.bind(function(a,c){var b=f(c);b.data("commentEntity",this);this.$el.prepend(b);this.update.initView(b);this.$hiddenComment=b},this));h.ajax({url:a})},undoHide:function(a){this.$el.removeClass("hidden");
e.call(this,"increment");h.ajax({url:a})}}})})();
(function(){var k=LIModules.requires("jquery"),e=LIModules.requires("underscore"),h=LIModules.requires("dust"),l=LIModules.requires("Events"),f=LIModules.requires("OzFeed"),m=LIModules.requires("OzFeedUpdate"),n=LIModules.requires("t8"),p=e.template("/profile/view?id\x3d\x3c%-id%\x3e\x26trk\x3dhp-feed-sharer-name"),q=e.template("/company/\x3c%-id%\x3e?\x26trk\x3dhp-feed-company-name"),r=e.template("/edu/school?id\x3d\x3c%-id%\x3e\x26trk\x3dhp-feed-school-name");m.addView({block:"comment-list",sync:!0,
methods:{init:function(){this.collapsedHeight=0;this.$list=this.$el.children();this.model.on("change:comments",this.render,this)},render:function(b,a,d){f.log("adding comments");b=this.model.get("comments");h.render("ozfeed-templates/partials/_inserted-comments",b[b.length-1],e.bind(function(a,b){this._$lastInsertedComments=k(b);this._$lastCommentEntities=this._$lastInsertedComments.children();this._$lastInsertedComments.addClass("highlighted");d.myComment?this._renderOwnComment():this._renderPreviousComments()},
this));setTimeout(e.bind(function(){this.model.set("comments",[],{silent:!0})},this),20)},_renderPreviousComments:function(){var b=this._$lastInsertedComments,a=this.$list;a[0].scrollTop=0;a.prepend(b);f.Util.truncateAll(b);b.css("margin-top",-(b.height()+5));this._setupTransition();this.update.initView(b.find("[data-block]"))},_renderOwnComment:function(){var b=this._$lastInsertedComments,a=this.$list,d;a.append(b);b.addClass("hidden");this._$lastCommentEntities.find("[data-truncate]").addClass("expanded").removeAttr("data-truncate");
this._setupTransition(!0);this.commentBox||(this.commentBox=this.update.getViews("comment-box")[0]);b=this.update.initView(b.find("[data-block]"),"comment-entity")[0];d=k(".rich-media-viewer .rmv-section .scrollable");a=d.length?d[0]:a[0];a.scrollTop=a.scrollHeight;return b},_setupTransition:function(b){var a=this._$lastInsertedComments;f.Util.setupTransition({$el:a,eventCallback:e.bind(function(b){"border-left-color"===b.originalEvent.propertyName?(a.off(f.Util.getTransitionEndEvent()),this._$lastCommentEntities.unwrap()):
(a.removeClass("inserting"),e.delay(function(){l.trigger("ozfeed-comment-list-render");a.removeClass("highlighted")},20))},this)});e.delay(function(){a.addClass("inserting");b?a.removeClass("hidden"):a.css("margin-top","")},20)},_applyMentionsHighlighting:function(b,a){var d=[],c,e;for(c=0;c<a.length;c++)d.push({template:"text",text:b.substring(c?a[c-1].index+a[c-1].length:0,a[c].index)}),e="company"===a[c].type?q({id:a[c].id}):"school"===a[c].type?r({id:a[c].id}):p({id:a[c].id}),d.push({template:"miniprofile",
mentioned:!0,url:e,name:b.substr(a[c].index,a[c].length),type:a[c].type+"-mention"});d.push({template:"text",text:b.substring(c?a[c-1].index+a[c-1].length:0,b.length)});return d},checkIfEmpty:function(){this.$list.children().length||this.$el.hide()},show:function(){this.$el.show()},insertComments:function(b,a){var d=this.model,c=d.get("comments")||[];this.show();c.push(b);d.set("comments",c,{silent:!0});d.trigger("change:comments",this.model,null,a||{})},addMyComment:function(b,a,d){var c=new n.Resources(h.i18n,
h),g=LIModules.requires("ozFeed").getMemberData(),f;c.get("i18n_now","ozfeed-templates/partials/_i18n",{},e.bind(function(c,d){f={blocks:[{template:"comment-entity",blocks:[{template:"images/xsmall-member-image",name:g.name,photo:g.photo,url:g.url,mprSize:100},{template:"header",blocks:[{template:"meta",timeAgo:d},{template:"sub-headlines/actor",name:g.name,url:g.url}]},{template:"text-entities/comment-text",wads:this._applyMentionsHighlighting(b,a)}]}]}},this));this.insertComments(f,{myComment:!0,
ajaxDeferred:d});this.commentsSocialSummary||(this.commentsSocialSummary=this.update.getViews("comments-social-summary")[0]);this.commentsSocialSummary?(this.commentsSocialSummary.incrementComments(),this.commentsSocialSummary.incrementOffset()):h.render("ozfeed-templates/blocks/social-summary/comments-social-summary",{total:1,allShown:!0},e.bind(function(a,b){var c=k(b),d=this.update.getViews("likes-social-summary")[0],e=this.update.getViews("actions",{$context:this.$el})[0];if(d)d.insertAfter(c);
else if(e)e.insertAfter(c);else return;this.commentsSocialSummary=this.update.initView(c)[0]},this));(d=this.update.getViews("show-previous-comments")[0])&&d.incrementOffset()}}})})();
(function(){var a=LIModules.requires("OzFeedUpdate"),b=LIModules.requires("OzFeed");a.addView({block:"comment",events:{click:function(a){b.log("clicked on comment");this._focusCommentBox()}},methods:{_focusCommentBox:function(){this.commentList||(this.commentList=this.update.getViews("comment-list")[0])&&this.commentList.show();this.showPreviousComments||(this.showPreviousComments=this.update.getViews("show-previous-comments")[0])&&this.showPreviousComments.show();this.commentBox||(this.commentBox=
this.update.getViews("comment-box")[0]);this.commentBox.focus()}}})})();
(function(){var e=LIModules.requires("jquery"),d=LIModules.requires("underscore"),f=LIModules.requires("OzFeedUpdate"),c=LIModules.requires("OzFeed");f.addView({block:"comments-social-summary",sync:!0,events:{click:function(a){this.url&&!this.fetching&&(c.log("fetch more comments"),this._fetchMoreComments())}},methods:{init:function(){var a=this.$el,b=this.model;this.$action=a.find(".count");this.url=this.$action.data("url");this.$loader=e('\x3cspan class\x3d"loading hidden"/\x3e');a.append(this.$loader);
b.set("fetching",!1);b.set("all-shown",a.find(".count").prop("disabled"));b.set("commentsCount",+a.data("count"));b.set("offset",this.url?+play.getUrlParameter(this.url,"offset"):0);b.set("insertCount",this.url?+play.getUrlParameter(this.url,"count"):0);b.on("change:commentsCount change:all-shown",this.render,this);b.on("change:fetching",this._toggleFetching,this);b.on("change:offset change:insertCount",this._updateUrl,this)},render:function(){dust.render("ozfeed-templates/blocks/social-summary/comments-social-summary",
{total:this.model.get("commentsCount"),url:this.url,allShown:this.model.get("all-shown")},d.bind(function(a,b){this.update.replaceAndBind(this.id,b);this.$el.toggleClass("hidden",0===this.model.get("commentsCount"))},this))},_toggleFetching:function(){var a=this.model,b=this.$action,c=this.$loader;a.get("fetching")?(b.prop("disabled",!0),c.removeClass("hidden")):(a.get("all-shown")||(b.prop("disabled",!1),b.focus()),c.addClass("hidden"))},_fetchMoreComments:function(){var a=this.model;a.set("fetching",
!0);void 0===this.commentList&&(this.commentList=this.update.getViews("comment-list")[0]||null);this.commentList&&c.Util.ajax({url:this.url,success:d.bind(function(a){c.log("ajax succeeded");void 0===this.showPreviousComments&&(this.showPreviousComments=this.update.getViews("show-previous-comments")[0]||null);this.commentList.show();this.commentList.insertComments(a);(this.url=a.paginationUrl)?(this.showPreviousComments&&this.showPreviousComments.incrementOffset(this.model.get("insertCount")),this.model.set("offset",
+play.getUrlParameter(this.url,"offset"),{silent:!0})):(this.allCommentsInjected(),this.showPreviousComments&&this.showPreviousComments.remove())},this),error:function(){c.log("ajax failed");c.log("error handler has not been implemented yet")},complete:function(){a.set("fetching",!1)}})},_updateUrl:function(){var a=this.model;this.url&&(this.url=play.addQueryParameter(this.url,"offset",""+a.get("offset")),this.url=play.addQueryParameter(this.url,"count",""+a.get("insertCount")))},incrementComments:function(){var a=
this.model;a.set("commentsCount",a.get("commentsCount")+1)},decrementComments:function(){var a=this.model;a.set("commentsCount",a.get("commentsCount")-1)},allCommentsInjected:function(){var a=this.model;this.url=null;a.set("all-shown",!0);a.off("change:all-shown")},incrementOffset:function(a){var b=this.model;b.set("offset",b.get("offset")+(a||1))},decrementOffset:function(a){var b=this.model;a=b.get("offset")-(a||1);b.set("offset",0>a?0:a)}}})})();
(function(){function d(a){e.addTooltips({$el:a,dataAttribute:k,type:c})}var g=LIModules.requires("jquery"),f=LIModules.requires("underscore"),l=LIModules.requires("Events"),m=LIModules.requires("OzFeedUpdate"),b=LIModules.requires("OzFeed"),e,c="delete-tooltip",h=c+"-id",k="data-"+h;m.addView({block:"delete-comment",events:{click:function(){b.log("clicked on delete comment button");this.closeTooltip();this._promptDelete()},focusin:function(){this.commentEntity.toggleHover(!0)},focusout:function(){this.commentEntity.toggleHover(!1)}},
methods:{init:function(){this.url=this.$el.data("url");this.params=this.$el.data("params");d(this.$el);this.commentEntity=this.update.getViews("comment-entity",{ancestor:"comment-entity",$context:this.$el,firstBlock:!1})[0]},_promptDelete:function(){var a=this.$el;a.data("dialog")||(this.textEntity=this.update.getViews("text-entity",{ancestor:"comment-entity",$context:a})[0],this._setupDialog())},_setupDialog:function(){var a={closeOnMaskClick:!0,decorators:["scripts/shared/Dialog/DecisionModalDialog"],
submitSelector:".confirm",submitCallback:f.bind(function(){var a=this.$el;this.url?(a.prop("dialog").close(),a=a.next(".comment-entity"),a.length&&a.focus(),this._deleteComment()):b.debug("delete url has not been initialized yet")},this),cancelSelector:".cancel",cancelCallback:f.bind(function(){this.$el.prop("dialog").close()},this)};b.Util.setupDialog({$el:this.$el,template:"ozfeed-templates/partials/_delete-comment-dialog",id:"delete-comment-dialog-"+this.id,data:{comment:this.textEntity.getContents()},
titleKey:"i18n_please_confirm",jsConfig:a})},_deleteComment:function(){b.Util.ajax({url:this.url,data:this.params,type:"POST"});this.closeTooltip();this.commentEntity.deleteSelf()},remove:function(){this.removeSelf()},closeTooltip:function(){this.$el.blur()}}});g(function(){f.defer(function(){e=LIModules.requires("ozFeed");e.addTooltipFactory({type:c,jsConfig:{tooltipContentID:c,dataAttribute:h,delayClose:0}});d(g(".delete-comment"));l.on(b.OZFEED_NEW_UPDATES_EVENT,function(a){d(a.newUpdates.find(".delete-comment"))})})})})();
(function(){LIModules.requires("jquery");var b=LIModules.requires("underscore"),a=LIModules.requires("OzFeed");LIModules.requires("OzFeedUpdate").addView({block:"delete-update",events:{click:function(){a.log("clicked on delete update button");this._promptDelete()}},methods:{init:function(){this.url=this.$el.data("url")},_promptDelete:function(){this.$el.data("dialog")||this._setupDialog()},_setupDialog:function(){var c={closeOnMaskClick:!0,decorators:["scripts/shared/Dialog/DecisionModalDialog"],
submitSelector:".confirm",submitCallback:b.bind(function(){this._deleteUpdate();this.$el.data("dialog").close()},this),cancelSelector:".cancel"};a.Util.setupDialog({$el:this.$el,template:"ozfeed-templates/partials/_delete-update-dialog",id:"delete-update-dialog",titleKey:"i18n_please_confirm",jsConfig:c})},_deleteUpdate:function(){a.Util.ajax({url:this.url,type:"POST"});this.update.deleteSelf()}}})})();
(function(){var b=LIModules.requires("OzFeed");LIModules.requires("OzFeedUpdate").addView({block:"dismiss-recommendation",events:{click:function(){this._dismissRecommendation()}},methods:{_dismissRecommendation:function(){var a=this.$el,c,d,e;c=this.update.getViews("recommendation-entity",{ancestor:"recommendation-entity",$context:a,firstBlock:!1})[0];d=a.data("recommendation-type");"endorsement"===d&&(e=a.data("dismiss-url"),a=a.data("signature"),b.Util.ajax({url:e,data:{csrfToken:b.Util.getCsrfToken(),
signature:a},success:function(){b.log("ajax call succeeded")},error:function(){b.log("ajax failed")}}));c&&c.remove("endorsement"===d)}}})})();
(function(){var a=LIModules.requires("OzFeed");LIModules.requires("OzFeedUpdate").addView({block:"dismiss-recommendation-endorse",events:{click:function(){a.log("clicked on dismiss recommendation endorse action");this._dismissRecommendation()}},methods:{_dismissRecommendation:function(){var b,c,d;b=this.update.getViews("recommendation-entity",{ancestor:"recommendation-entity",$context:this.$el,firstBlock:!1})[0];c=b.$el.closest(".recommendations").data("dismiss-url");d=b.$el.data("signature");a.Util.ajax({url:c,
data:{csrfToken:a.Util.getCsrfToken(),signature:d},success:function(){a.log("ajax call succeeded")},error:function(){a.log("ajax failed")}});b.remove(!0)}}})})();
(function(){var b=LIModules.requires("OzFeed");LIModules.requires("OzFeedUpdate").addView({block:"dismiss-update",events:{click:function(a){b.log("clicked on dismiss action");this._dismiss()}},methods:{_dismiss:function(){this.update.dismissSelf(_.bind(function(){var a=this.update.$el.parents(".feed.updates.promo");this.update.$el.remove();a.length&&a.remove()},this))}}})})();
(function(){LIModules.requires("underscore");var b=LIModules.requires("OzFeed");LIModules.requires("OzFeedUpdate").addView({block:"hide-update",events:{click:function(){b.log("clicked on hide update button");this._hideUpdate()}},methods:{init:function(){var a=this.$el;this.hideUrl=a.data("hide-url");this.undoUrl=a.data("undo-url");this.fromActor=a.data("from-actor");this.enableActivityHide=a.data("enable-activity-hide")},_hideUpdate:function(){b.Util.ajax({url:this.hideUrl,type:"POST"});this.update.hideSelf(this.undoUrl,
this.fromActor,this.enableActivityHide)}}})})();
(function(){LIModules.requires("underscore");var b=LIModules.requires("OzFeed");LIModules.requires("OzFeedUpdate").addView({block:"unfollow-update",events:{click:function(){b.log("clicked on unfollow update button");this._hideUpdate()}},methods:{init:function(){var a=this.$el;this.unfollowUrl=a.data("unfollow-url");this.undoUrl=a.data("undo-url");this.fromActor=a.data("from-actor");this.actorName=a.data("actor-name")},_hideUpdate:function(){debugger;b.Util.ajax({url:this.unfollowUrl,type:"POST"});
this.update.hideSelfForUnfollow(this.undoUrl,this.fromActor,this.actorName)}}})})();
(function(){var a=LIModules.requires("jquery");LIModules.requires("underscore");LIModules.requires("OzFeed");LIModules.requires("OzFeedUpdate").addView({block:"hidden-comment",events:{click:function(b){a(b.target).is(".undo")&&this.undo()}},methods:{init:function(){this.commentEntity=this.update.getViews("comment-entity",{ancestor:"comment-entity",$context:this.$el,firstBlock:!1})[0];this.undoUrl=this.$el.find(".undo").data("url")},undo:function(){this.commentEntity.undoHide(this.undoUrl)}}})})();
(function(){LIModules.requires("jquery");LIModules.requires("underscore");var a=LIModules.requires("OzFeed");LIModules.requires("OzFeedUpdate").addView({block:"scin-debug",events:{click:function(){this._openDialog()}},methods:{init:function(){this.debugString=this.$el.data("debug-string")},_openDialog:function(){this.$el.data("dialog")||this._setupDialog()},_setupDialog:function(){a.Util.setupDialog({$el:this.$el,template:"ozfeed-templates/partials/_scin-debug-dialog",id:"scin-debug-dialog",titleKey:"i18n_scin_debug_info",
jsConfig:{closeOnMaskClick:!0,decorators:["scripts/shared/Dialog/DecisionModalDialog"],cancelSelector:".cancel"},data:{debugString:this.debugString}})}}})})();
(function(){function b(b){c.addTooltips({$el:b,dataAttribute:f,type:a})}var d=LIModules.requires("jquery"),g=LIModules.requires("underscore");LIModules.requires("dust");var h=LIModules.requires("Events"),k=LIModules.requires("OzFeedUpdate"),l=LIModules.requires("OzFeed"),c,a="flag-hide-tooltip",e=a+"-id",f="data-"+e;k.addView({block:"flag-hide-comment",events:{click:function(){this.hide()},focusin:function(){this.commentEntity.toggleHover(!0)},focusout:function(){this.commentEntity.toggleHover(!1)}},
methods:{init:function(){this.url=this.$el.data("url");this.undoUrl=this.$el.data("undo-url");b(this.$el);this.commentEntity=this.update.getViews("comment-entity",{ancestor:"comment-entity",$context:this.$el,firstBlock:!1})[0]},hide:function(){this.closeTooltip();this.commentEntity.hide(this.url,this.undoUrl)},closeTooltip:function(){this.$el.blur()}}});d(function(){g.defer(function(){c=LIModules.requires("ozFeed");c.addTooltipFactory({type:a,jsConfig:{tooltipContentID:a,dataAttribute:e,delayClose:0}});
b(d(".flag-hide-comment"));h.on(l.OZFEED_NEW_UPDATES_EVENT,function(a){b(a.newUpdates.find(".flag-hide-comment"))})})})})();
(function(){var b=LIModules.requires("underscore"),a=LIModules.requires("OzFeed");LIModules.requires("OzFeedUpdate").addView({block:"follow",events:{click:function(c){a.log("clicked on follow action");this._follow()}},methods:{init:function(){this.url=this.$el.data("url");this.model.set("state","not-following");this.model.on("change:state",this.render,this)},render:function(){dust.render("ozfeed-templates/blocks/actions/follow/following",{},b.bind(function(a,b){this.$el.replaceWith(b);this.model.off("change:state")},
this))},_follow:function(){var c=this.update.getViews("recommendation-entity",{ancestor:"recommendation-entity",$context:this.$el,firstBlock:!1})[0];a.Util.ajax({url:this.url,type:"POST",success:b.bind(function(){a.log("ajax succeeded")},this),error:function(){a.log("ajax failed");a.log("error handler has not been implemented yet")}});this.model.set("state","following");c&&c.remove()}}})})();
(function(){var c=LIModules.requires("jquery"),s=LIModules.requires("Events"),h=LIModules.requires("OzFeed");c(function(){function k(){function t(a){a=b.FLAG_PRE+a;x.removeClass(l).addClass(b.COUNTRY_FLAGS).addClass(a);l=a}function m(a){a=(new t8.Resources(dust.i18n,dust)).getStaticString(a,y.GTA);f.addClass(b.HIDDEN);f.html(a);f.removeClass(b.HIDDEN)}function z(){var a=d.val(),e=g.val(),f=n.attr("action");p.prop(u.DISABLED,!0);c.ajax({method:"POST",url:f,data:{csrfToken:h.Util.getCsrfToken(),countryCode:a,
phoneNumber:e},beforeSend:function(a){a.setRequestHeader("X-IsAJAXForm","1")},success:function(a){a=p.data("nux-url");window.location.href=a},error:function(a){m(q.GLOBAL_ERROR)},complete:function(){v.removeClass(b.LOADING);p.prop(u.DISABLED,!1)}})}function A(){var a=d.val()||B,e=d.find(":selected").data("li-phone-code");l=b.FLAG_PRE+a;t(a);w.html("+".concat(e))}var b={COUNTRY_FLAGS:"country-flags",ERROR:"error",FLAG_PRE:"flag-",HIDDEN:"hidden"},u={DISABLED:"disabled"},C=/[0-9\-\s\+\(\)\.]{4,15}/,
q={COUNTRY_ERROR:"gta_country_error",GLOBAL_ERROR:"gta_global_error",PHONE_ERROR:"gta_phone_error"},y={GTA:"ozfeed-templates/blocks/gta"},B="us",l,n=c("#get-the-app-feed-form"),v=c(".message-loader"),x=c(".country-flags"),d=c(".country-dropdown"),f=c(".flash-alerts"),g=c(".phone-input"),w=c("#phone-code-display"),p=c(".submit-button");n.on("submit",function(a){var e;a.preventDefault();e=g.val().match(C);a=d.val()?!0:!1;f.addClass(b.HIDDEN);d.removeClass(b.ERROR);g.removeClass(b.ERROR);a&&e?(v.addClass(b.LOADING),
z()):a?e||(g.addClass(b.ERROR),m(q.PHONE_ERROR)):(d.addClass(b.ERROR),m(q.COUNTRY_ERROR))});d.on("change",function(a){var b=c(this).find(":selected");a=b.attr("value");b=b.data("li-phone-code");t(a);w.html("+".concat(b))});n.length&&!r&&(r=!0,A());r&&s.off(h.OZFEED_NEW_UPDATES_EVENT,k)}var r=!1;k();s.on(h.OZFEED_NEW_UPDATES_EVENT,k)})})();
(function(){var b=LIModules.requires("underscore"),a=LIModules.requires("OzFeed");LIModules.requires("OzFeedUpdate").addView({block:"join-group",events:{click:function(b){a.log("clicked on join-group action");this._joinGroup()}},methods:{init:function(){this.url=this.$el.data("url");this.model.set("state","not-member");this.model.on("change:state",this.render,this)},render:function(){dust.render("ozfeed-templates/blocks/actions/join-group/member",{},b.bind(function(a,b){this.$el.replaceWith(b);this.model.off("change:state")},
this))},_joinGroup:function(){a.Util.ajax({url:this.url,type:"POST",success:b.bind(function(){a.log("ajax call succeeded")},this),error:function(){a.log("ajax failed");a.log("error handler has not been implemented yet")}});this.model.set("state","member")}}})})();
(function(){var f=LIModules.requires("jquery"),c=LIModules.requires("underscore"),d=LIModules.requires("OzFeed"),h={liked:"unlike","not-liked":"like"};LIModules.requires("OzFeedUpdate").addView({block:"like",sync:!0,events:{click:function(a){this._toggleLike();this.mouseAction=!1},mousedown:function(a){this.mouseAction=!0}},methods:{init:function(){var a=this.$el,b=this.model;this.likeUrl=a.data("like-url");this.unlikeUrl=a.data("unlike-url");this.likeData=a.data("like-data");this.unlikeData=a.data("unlike-data");
this.type=a.data("type");this.queue=[];this.sending=!1;b.set("state",a.data("liked")?"liked":"not-liked");b.on("change:state",this.render,this)},render:function(){var a=new f.Deferred,b;this._renderAction(a);b=new f.Deferred;this._renderSocialSummary(b);f.when(b.promise(),a.promise()).done(c.bind(function(){this.isLiked()?this.socialSummary.incrementLikes():this.socialSummary.decrementLikes()},this))},_renderAction:function(a){dust.render("ozfeed-templates/blocks/actions/like/"+h[this.model.get("state")],
{state:this.model.get("state"),likeUrl:this.likeUrl,unlikeUrl:this.unlikeUrl,type:this.type},c.bind(function(b,e){this.update.replaceAndBind(this.id,e);a.resolve()},this));this.mouseAction||a.done(c.bind(this.$el.focus,this.$el))},_renderSocialSummary:function(a){var b;this.socialSummary||(this.socialSummary=this.update.getViews("likes-social-summary")[0]);if(this.socialSummary)a.resolve();else{b=c.filter(this.update.getViews("actions"),c.bind(function(a){return a.$el.find(this.$el).length},this))[0];
if(!b)return a.reject();dust.render("ozfeed-templates/blocks/social-summary/likes-social-summary",{total:0,noModal:!0},c.bind(function(c,d){var g=f(d);b.insertAfter(g);this.socialSummary=this.update.initView(g)[0];a.resolve()},this))}},_handleAjax:function(a,b){var e;a&&this.queue.push({url:a,data:b});this.sending||(this.sending=!0,e=this.queue.shift(),d.Util.ajax({url:e.url,type:"POST",data:e.data,success:c.bind(function(){this.sending=!1;this.queue.length&&this._handleAjax()},this),error:function(){d.log("ajax call failed");
d.log("error handler has not been implemented yet")}}))},_toggleLike:function(){var a="liked"===this.model.get("state"),b=a?"not-liked":"liked";this._handleAjax(a?this.unlikeUrl:this.likeUrl,a?this.unlikeData:this.likeData);this.model.set("state",b)},isLiked:function(){return"liked"===this.model.get("state")}}})})($,LI,dust);
(function(){var c=LIModules.requires("jquery"),d=LIModules.requires("underscore"),e=LIModules.requires("Events"),f=LIModules.requires("OzFeed");LIModules.requires("OzFeedUpdate").addView({block:"likes-social-summary",events:{click:function(a){this.noModal||e.trigger("click-show-likes",{$el:c(a.target)})}},methods:{init:function(){var a=this.$el,b=a.find(".count");this.url=b.data("href");this.noModal=b.prop("disabled");this.model.set("likesCount",+a.data("count"));this.model.on("change:likesCount",
this.render,this)},render:function(){f.log("rerender social summary likes");dust.render("ozfeed-templates/blocks/social-summary/likes-social-summary",{total:this.model.get("likesCount"),url:this.url,noModal:this.noModal},d.bind(function(a,b){this.update.replaceAndBind(this.id,b);this.$el.toggleClass("hidden",0===this.model.get("likesCount"))},this))},incrementLikes:function(){var a=this.model;a.set("likesCount",a.get("likesCount")+1)},decrementLikes:function(){var a=this.model;a.set("likesCount",
a.get("likesCount")-1)},insertAfter:function(a){this.$el.after(a)}}})})();
(function(){function b(e){LIModules.requires("ozFeed").addTooltips({$el:e,dataAttribute:f,type:a})}var c=LIModules.requires("jquery"),g=LIModules.requires("underscore"),h=LIModules.requires("OzFeed"),k=LIModules.requires("Events"),a="sponsored-tooltip",d=a+"-id",f="data-"+d;c(window).load(function(){g.defer(function(){LIModules.requires("ozFeed").addTooltipFactory({type:a,jsConfig:{type:"hovercard",tooltipContentID:a,dataAttribute:d}});b(c(".sponsored"));k.on(h.OZFEED_NEW_UPDATES_EVENT,function(a){b(a.newUpdates.find(".sponsored"))})})})})();
(function(){var d=LIModules.requires("jquery"),c=LIModules.requires("OzFeed");LIModules.requires("OzFeedUpdate").addView({block:"permalink",events:{click:function(b){c.log("clicked on permalink button");this._promptCopy()}},methods:{init:function(){var b=window.location.host,a=this.$el.data("permalink-url");this.url=b+a},_promptCopy:function(){this.$el.data("dialog")||this._setupDialog()},_setupDialog:function(){var b=this;c.Util.setupDialog({$el:this.$el,template:"ozfeed-templates/partials/_copy-permalink-dialog",
id:"copy-permalink-dialog",data:{permalinkUrl:this.url},titleKey:"i18n_permalink",jsConfig:{callbacks:{afterOpen:function(){var a=d(".permalink-url");a.focus();a.select();a.click(function(){this.select()})},afterClose:function(){b.$el.removeData("dialog")}}}})}}})})();
(function(){var d=LIModules.requires("jquery"),e=LIModules.requires("underscore"),f=LIModules.requires("OzFeed"),g={collapsed:"ozfeed-templates/blocks/rich-media/presentation",expanded:"ozfeed-templates/partials/_embedly"};LIModules.requires("OzFeedUpdate").addView({block:"presentation",events:{click:function(a){var b=d(a.target);a.preventDefault();if(b.parents("a").length||b.is("a"))b.is(".close")?this.model.set("state","collapsed"):this.model.get("fetching")||this._embedly(this.url,e.bind(function(){this.model.set("state",
"expanded")},this),e.bind(function(){f.log("error handler has not been implemented yet")},this))}},methods:{init:function(){var a=this.model,b=this.$el.find(".image");this.$loader=d('\x3cspan class\x3d"loading hidden"/\x3e');this.url=b.attr("href");b.append(this.$loader);a.set("state","collapsed");a.set("fetching",!1);a.on("change:state",this.render,this);a.on("change:fetching",this._toggleFetching,this)},render:function(){var a=this.$el,b=this.model.get("state");a.css("height",this.embedlyCache.height);
dust.render(g[b],this.embedlyCache,function(b,c){a.html(c);a.css("height",a.find(".embedly").height())});a.addClass("presentation-"+b)},_toggleFetching:function(){this.$loader.toggleClass("hidden",!this.model.get("fetching"))},_embedly:function(a,b,f){var c=this.model;c.set("fetching",!0);this.embedlyCache?(b(this.embedlyCache),c.set("fetching",!1)):(c.set("fetching",!0),d.getJSON("//api.embed.ly/1/oembed?"+d.param({key:"b8949c0eb73c11e089614040d3dc5c07",url:a,width:Math.floor(this.$el.width()),autoplay:!0,
secure:0<=location.protocol.indexOf("https")})+"\x26callback\x3d?").done(e.bind(function(a){this.embedlyCache=a;b(a)},this)).fail(f).always(function(){c.set("fetching",!1)}))}}})})();
(function(){var d=LIModules.requires("underscore"),e=LIModules.requires("OzFeed");LIModules.requires("OzFeedUpdate").addView({block:"recommendation-entity",methods:{init:function(){this.model.set("state","shown");this.model.on("change:state",this.render,this)},render:function(){this.$el.addClass("remove");this.model.off("change:state")},_removeBlock:function(){var a,b;this.removeSelf();this.recommendations.resetList(!1);if(this.recommendations.getList().length<=this.recommendations.numVisibleRecommendations){a=
this.update.getViews("see-more-recommendations")[0];b=this.update.getViews("dismiss-recommendation");a&&a.remove();a=0;for(var c=b.length;a<c;a++)b[a].removeSelf()}},remove:function(a){var b=this.$el,c;this.recommendations=this.update.getViews("recommendations")[0];this.recommendations||(this.recommendations=this.update.getViews("recommendations-endorse")[0]);if(this.recommendations.lixEndorsementsRedesign||this.recommendations.getList().length>this.recommendations.numVisibleRecommendations)a?this.model.set("state",
"remove"):setTimeout(d.bind(function(){this.model.set("state","remove")},this),200),c=e.Util.setupTransition({$el:b,deferred:c,eventCallback:d.bind(function(a){"width"===a.originalEvent.propertyName&&this._removeBlock()},this)})}}})})();
(function(){function f(a,b){a&&(b&&b.length)&&c.Util.ajax({url:a,data:{csrfToken:c.Util.getCsrfToken(),signatures:b},success:function(){c.log("impression ajax succeeded")},error:function(){c.log("impression ajax failed")}})}function g(a){var b=[];d.each(a,function(a){a=e(a);a.data(h)||(b.push(a.data("signature")),a.data(h,!0))});return b}var e=LIModules.requires("jquery"),d=LIModules.requires("underscore"),c=LIModules.requires("OzFeed"),k=LIModules.requires("OzFeedUpdate"),l=LIModules.requires("UserActivityTrackingInstance"),
h="impressioned";k.addView({block:"recommendations",methods:{init:function(){var a=this.$el,b=this.model;this.impressionUrl=a.data("impression-url");this.fetchUrl=a.data("fetch-url");this.numVisibleRecommendations=3;b.set("recommendationsList",[]);this._resetBuffer();this._resetList();b.on("change:pendingRecommendations",this.render,this);b.on("change:recommendationsList",d.debounce(d.bind(this._fireImpressionEvent,this),500))},render:function(){dust.render("ozfeed-templates/blocks/recommendations",
this.model.get("pendingRecommendations"),d.bind(function(a,b){var c=e("\x3cdiv/\x3e").html(b).find(".recommendation-entity");this.$el.append(c);this.update.initView(c.find("button[data-block]").addBack());this._resetBuffer()},this))},_resetBuffer:function(){this.model.set("pendingRecommendations",{},{silent:!0})},_resetList:function(a){this.model.set("recommendationsList",this.update.getViews("recommendation-entity"),{silent:"boolean"===typeof a?a:!0})},_fireImpressionEvent:function(){var a=this.model.get("recommendationsList").slice(0,
3),a=d.map(a,function(a){return a.$el}),b=g(a);e.each(a,function(){var a=e(this);a.attr("data-li-utrk-impr_fired")||a.attr("data-li-utrk-impr","")});l.fireImpressionEvents(this.$el);f(b);this._addRecommendations()},_addRecommendations:function(){12>=this.model.get("recommendationsList").length&&c.Util.ajax({url:this.fetchUrl,success:d.bind(function(a){c.log("ajax call to add more recommendations succeeded");this.model.set("pendingRecommendations",a,{silent:!0});this._resetList()},this),error:function(){c.log("ajax to add more recommendations failed")}})},
getList:function(){return this.model.get("recommendationsList")},resetList:function(a){this._resetList(!1)},resetVisibleRecommendations:function(){var a=this.model.get("recommendationsList");a.length||(this._resetList(),a=this.model.get("recommendationsList"));d.each(a.slice(0,3),function(a){a.remove()})}}});e(function(){e('[data-block\x3d"recommendations"]').each(function(){var a=e(this),b=a.find(".recommendation-entity").slice(0,3),b=g(b);f(a.data("impression-url"),b)})})})();
(function(){var e=LIModules.requires("jquery"),b=LIModules.requires("underscore"),g=LIModules.requires("OzFeed"),h=LIModules.requires("OzFeedUpdate"),k=LIModules.requires("UserActivityTrackingInstance");h.addView({block:"rollup",methods:{init:function(){this._resetBuffer();this.height=this.originalHeight=this.$el.outerHeight(!0);this.injectModuleKey=this.$el.data("rollup-inject-module-key");this.model.on("change:pendingUpdates",this.render,this)},render:function(){g.log("adding updates");this.$el.css("height",
this.height);dust.render("ozfeed-templates/blocks/rollup",this.model.get("pendingUpdates"),b.bind(function(a,b){var f=this,c=this.$el,d=e(b).children();c.append(d);d.each(function(){f.height+=e(this).outerHeight(!0)});this.update.initView(d.find("[data-block]"));c.css("height",this.height);k.fireImpressionEvents(c,this.injectModuleKey);this._resetBuffer()},this))},_resetBuffer:function(){this.model.set("pendingUpdates",{},{silent:!0})},toggleList:function(){var a=this.$el;this.fullHeight=this.fullHeight||
a.height();a.hasClass("less-shown")?(a.removeClass("less-shown"),a.css("height",this.fullHeight)):(a.addClass("less-shown"),a.css("height",this.originalHeight-1))},insertUpdates:function(a){this.model.set("pendingUpdates",a)},setDone:function(){this.$el.addClass("full")}}})})();
(function(){var d=LIModules.requires("jquery"),e=LIModules.requires("underscore"),c=LIModules.requires("OzFeed"),f=LIModules.requires("OzFeedUpdate");LIModules.imports("TrackFailure");f.addView({block:"rollup-video",events:{click:function(a){var b=d(a.target);c.Util.embed.isEmbeddable(this.url)&&(a.preventDefault(),b.closest("a").length&&this.$loader.hasClass("hidden")&&(this._embed().done(e.bind(this._render,this)).fail(e.bind(function(){this.$loader.addClass("hidden");c.log("error handler has not been implemented yet")},
this)),this.$loader.removeClass("hidden")))}},methods:{init:function(){var a=this.$el.find(".image");this.$loader=d('\x3cspan class\x3d"loading hidden"/\x3e');this.url=a.attr("href");a.append(this.$loader)},_embed:function(){var a=d.Deferred();this.embedlyCache?a.resolve(this.embedlyCache):c.Util.embed.withEmbedly(this.url,this.$el.width()).done(function(b){this.embedlyCache=b;a.resolve(b)}).fail(a.reject);return a.promise()},_render:function(a){var b=this.$el,c;a.truncateDescription=!0;a.author=
b.find("cite").data("author");dust.render("ozfeed-templates/partials/_embedly",a,function(a,e){a||(c=d(e),c.find(".embedly-info").append(b.find(".actions")),b.prepend(c),b.get(0).offsetHeight,b.addClass("video-expanded"))})}}})})();
(function(){var a=LIModules.requires("OzFeed");LIModules.requires("OzFeedUpdate").addView({block:"see-more-recommendations",events:{click:function(){a.log("clicked on see more recommendations action");this._seeMoreRecommendations()}},methods:{_seeMoreRecommendations:function(){this.recommendationsBlock=this.update.getViews("recommendations")[0];this.recommendationsBlock||(this.recommendationsBlock=this.update.getViews("recommendations-endorse")[0]);this.recommendationsBlock.resetVisibleRecommendations()},
remove:function(){this.removeSelf()}}})})();
(function(){var b=LIModules.requires("jquery"),d=LIModules.requires("underscore"),c=LIModules.requires("OzFeed"),e=LIModules.requires("OzFeedUpdate");LIModules.requires("UserActivityTrackingInstance");e.addView({block:"share",events:{click:function(a){c.log("clicked on share");this._share()}},methods:{_addTracking:function(){var a=b(".share-dialog");a.find("#share-text");a.attr("data-li-utrk-ref","[data-update-id\x3d"+this.update.$el.data("update-id")+"]");a.find('.submit-container input[type\x3d"submit"]').attr("data-li-auto-click-utrki",
"y\x3dSHARE\x26u\x3dreShareButton\x26n\x3dreShareUpdate");a.find(".dialog-close").attr("data-li-auto-click-utrki","y\x3dDISMISS\x26u\x3dreShareDismissCTA\x26n\x3ddismissReShare")},_setupDialog:function(){c.Util.setupDialog({$el:this.$el,titleKey:"i18n_share",ajaxDialog:!0,jsConfig:{width:590,top:100,callbacks:{afterOpen:this._fixedDialogPosition},fitToWindow:!1,customClassName:"share-dialog",decorators:["scripts/shared/Dialog/AjaxLoading"]}});this.$el.data("dialog").after("setDialogBodyContent",d.bind(this._addTracking,
this))},_fixedDialogPosition:function(){b("#dialog-mask").scrollTop(0)},_share:function(){this.$el.data("dialog")||this._setupDialog()}}})})();
(function(){var b=LIModules.requires("jquery"),d=LIModules.requires("underscore"),e=LIModules.requires("OzFeedUpdate"),f=LIModules.requires("OzFeedRichMediaViewer");e.addView({block:"shared-image",events:{click:function(a){this.$el.data("rmv-url")&&(a.preventDefault(),!this.richMediaViewer&&b(a.target).is("img")&&this._setupDialog(),this.richMediaViewer.isReady.done(d.bind(function(){this.richMediaViewer.open()},this)))}},methods:{init:function(a){a=this.$el;this.rmvTitle=a.data("rmv-title");this.rmvUrl=
a.data("rmv-url");this.parentUpdateID=this.update.id;this.$image=a.find("img")},_setupDialog:function(){this.richMediaViewer=new f(this.$image,{title:this.rmvTitle,customClassName:"rich-media-viewer-dialog",templateDataUrl:this.rmvUrl,top:75,centerVertically:!0,dustContentTemplate:"ozfeed-templates/partials/_rich-media-viewer",decorators:["scripts/shared/Dialog/AjaxDustLoading"],callbacks:{contentRenderSuccess:d.bind(this._handleRMVRendered,this)}})},_addTracking:function(){var a=b(".rich-media-viewer-dialog"),
c=a.children().first();c.attr("data-li-utrk-ref","[data-update-id\x3d"+this.update.$el.data("update-id")+"]");c.find(".comment-box").on("keypress","textarea",function(){c.find('button[data-trk\x3d"comment-submit"]').attr("data-li-auto-click-utrki","u\x3drichMediaDialogCommentSubmitCTA\x26n\x3dsubmitComment\x26y\x3dCOMMENT")});a.find(".dialog-close").attr("data-li-auto-click-utrki","u\x3drichMediaDialogDismiss\x26n\x3ddismissRichMedia\x26y\x3dDISMISS");a.find('[data-trk\x3d"show-previous-comments"]').attr("data-li-auto-click-utrki",
"u\x3drichMediaDialogPreviousCommentsCTA\x26n\x3dexpandComments\x26y\x3dEXPAND");a.find('[data-trk\x3d"likes-social-summary"]').attr("data-li-auto-click-utrki","u\x3drichMediaDialogLikerNumber\x26n\x3dexpandLikers\x26y\x3dEXPAND");a.find('[data-trk\x3d"comments-social-summary"]').attr("data-li-auto-click-utrki","u\x3drichMediaDialogCommenterNumber\x26n\x3dexpandComments\x26y\x3dEXPAND");a.find('[data-trk\x3d"comment"]').attr("data-li-auto-click-utrki","u\x3drichMediaDialogCommentCTA\x26n\x3dexpandComment\x26y\x3dEXPAND");
a.find('[data-block\x3d"share"]').attr("data-li-auto-click-utrki","u\x3drichMediaDialogShareCTA\x26n\x3dexpandShare\x26y\x3dEXPAND");a.find('[data-trk\x3d"member-commenter-name"]').attr("data-li-auto-click-utrki","u\x3drichMediaDialogCommenterName\x26n\x3dviewMemberProfile\x26y\x3dCLICK");a.find('[data-trk\x3d"member-commenter-image"]').attr("data-li-auto-click-utrki","u\x3drichMediaDialogCommenterPhoto\x26n\x3dviewMemberProfile\x26y\x3dCLICK");a.find('[data-trk\x3d"member-post-name"]').attr("data-li-auto-click-utrki",
"u\x3drichMediaDialogActorName\x26n\x3dviewMemberProfile\x26y\x3dCLICK");a.find('[data-trk\x3d"company-post-name"]').attr("data-li-auto-click-utrki","u\x3drichMediaDialogActorName\x26n\x3dviewCompanyPage\x26y\x3dCLICK");a.find('[data-trk\x3d"member-post-image"]').attr("data-li-auto-click-utrki","u\x3drichMediaDialogActorPhoto\x26n\x3dviewMemberProfile\x26y\x3dCLICK");a.find('[data-trk\x3d"company-post-image"]').attr("data-li-auto-click-utrki","u\x3drichMediaDialogActorPhoto\x26n\x3dviewCompanyPage\x26y\x3dCLICK");
a.find('[data-trk\x3d"influencer-logo"]').attr("data-li-auto-click-utrki","u\x3drichMediaDialogInfluencerLogo\x26n\x3dviewMemberProfile\x26y\x3dCLICK");a.find('[data-trk\x3d"flag-hide-comment"]').attr("data-li-auto-click-utrki","y\x3dHIDE\x26u\x3dflagAndHideCTA\x26n\x3dflagAndHideComment");a.on("mousedown","[data-block\x3dlike], [data-block\x3dhidden-comment]",function(){var a=b(this);switch(a.attr("data-block")){case "like":a.attr("data-li-auto-click-utrki",a.data("liked")?"u\x3drichMediaDialogUnlikeCTA\x26n\x3dunlikeUpdate\x26y\x3dUNLIKE":
"u\x3drichMediaDialogLikeCTA\x26n\x3dlikeUpdate\x26y\x3dLIKE");break;case "hidden-comment":a.find(".undo").attr("data-li-auto-click-utrki","u\x3dunflagOrUnhideCTA\x26n\x3dunflagOrUnhideComment\x26y\x3dUNHIDE")}})},_handleRMVRendered:function(){var a=b(".rich-media-viewer").first();a.attr("data-update-id",this.update.$el.data("update-id"));new e(a,!0);a.find('[data-block\x3d"shared-image"]').removeAttr("data-block").data("block",null);a.find(".expanding-image").attr("target","_blank");this._addTracking()}}})})();
(function(){var c=LIModules.requires("jquery"),a=LIModules.requires("underscore"),b=LIModules.requires("OzFeed");LIModules.requires("OzFeedUpdate").addView({block:"shares-social-summary",events:{click:function(a){b.log("clicked on shares social-summary");c(a.target).not("a").length&&(this.url&&!this.fetching)&&this._fetchShares()}},methods:{init:function(){this.url=this.$el.data("url");this.fetching=!1},_renderAggregatedShares:function(){(this.aggregatedSharesList=this.update.getViews("aggregated-shares-list")[0])?
this.aggregatedSharesListDeferred.resolve():dust.render("ozfeed-templates/blocks/aggregated-shares-list",{},a.bind(function(a,b){var d=c(b);this.update.append(d);this.aggregatedSharesList=this.update.initView(d)[0];this.aggregatedSharesListDeferred.resolve()},this))},_handleAjax:function(){this.fetching=!0;return b.Util.ajax({url:this.url,success:a.bind(function(a){b.log("ajax call succeeded")},this),error:a.bind(function(){b.log("ajax call failed")},this),complete:a.bind(function(){this.fetching=
!1},this)})},_fetchShares:function(){this.aggregatedSharesListDeferred=new c.Deferred;this._renderAggregatedShares();this.aggregatedSharesListDeferred.done(a.bind(this.aggregatedSharesList.triggerLoading,this.aggregatedSharesList));c.when(this._handleAjax(),this.aggregatedSharesListDeferred.promise()).done(a.bind(function(a){this.aggregatedSharesList.insertShares(a)},this)).fail(a.bind(function(){this.aggregatedSharesList.insertShares()},this)).always(a.bind(function(){this.url=null;this.$el.addClass("all-shown");
this.$el.find(".show-others").prop("disabled",!0)},this))}}})})();
(function(){var c=LIModules.requires("underscore"),b=LIModules.requires("OzFeed");LIModules.requires("OzFeedUpdate").addView({block:"show-all-updates",events:{click:function(a){b.log("clicked on show-all-updates button");this.url?this.model.get("fetching")||this._fetchAllUpdates():this._toggleList()}},methods:{init:function(){var a=this.model;this.url=this.$el.data("url");this.offset=+play.getUrlParameter(this.url,"offset");a.set("fetching",!1);a.set("offset",this.url?+play.getUrlParameter(this.url,
"offset"):0);a.on("change:fetching",this._toggleFetching,this);a.on("change:offset",this._updateUrl,this)},_toggleFetching:function(){this.$el.prop("disabled",this.model.get("fetching"))},_toggleList:function(){this.list.toggleList();this.showMoreUpdatesBlock.toggleShowFewer()},_fetchAllUpdates:function(){var a=this.model;a.set("fetching",!0);b.Util.ajax({url:this.url,success:c.bind(function(a){this.list||(this.list=this.update.getViews("rollup")[0]||this.update.getViews("aggregated-shares-list")[0]);
this.showMoreUpdatesBlock||(this.showMoreUpdatesBlock=this.update.getViews("show-more-updates")[0]);this.list.insertUpdates(a);this.list.setDone();this.setDone();this.showMoreUpdatesBlock&&this.showMoreUpdatesBlock.setDone()},this),error:function(){b.log("ajax failed");b.log("error handler has not been implemented yet")},complete:function(){a.set("fetching",!1)}})},_updateUrl:function(){this.url&&(this.url=play.addQueryParameter(this.url,"offset",this.model.get("offset")))},setDone:function(){this.url=
null},incrementOffset:function(a){var b=this.model;b.set("offset",b.get("offset")+(a||3))}}})})();
(function(){var d=LIModules.requires("jquery"),e=LIModules.requires("underscore"),b=LIModules.requires("OzFeed");LIModules.requires("OzFeedUpdate").addView({block:"show-more-updates",events:{click:function(a){b.log("clicked on show-more-updates button");this.list||(this.list=this.update.getViews("rollup")[0]||this.update.getViews("aggregated-shares-list")[0]);this.showAllUpdates||(this.showAllUpdates=this.update.getViews("show-all-updates")[0]);d(a.target).hasClass("show-action")&&(this.url?this.model.get("fetching")||
this._fetchMoreUpdates():this._toggleList())}},methods:{init:function(){var a=this.$el,c=this.model;this.$action=a.find(".show-action");this.url=this.$action.data("url");this.$loader=d('\x3cspan class\x3d"loading hidden"/\x3e');a.append(this.$loader);c.set("show-fewer",!1);c.set("fetching",!1);c.on("change:show-fewer",this.render,this);c.on("change:fetching",this._toggleFetching,this)},render:function(){var a=this.model.get("show-fewer")?"show-fewer-updates":"show-more-updates";dust.render("ozfeed-templates/blocks/show-more-updates/"+
a,{},e.bind(function(a,b){this.update.replaceAndBind(this.id,b);this.$el.focus()},this))},_toggleFetching:function(){var a=this.$action,c=this.$loader;this.model.get("fetching")?(a.prop("disabled",!0),c.removeClass("hidden")):(a.prop("disabled",!1),a.focus(),c.addClass("hidden"))},_toggleList:function(){this.list.toggleList();this.model.set("show-fewer",!this.model.get("show-fewer"))},_fetchMoreUpdates:function(){var a=this.model;a.set("fetching",!0);b.Util.ajax({url:this.url,success:e.bind(function(a){var b=
this.list;b.insertUpdates(a);(this.url=a.paginationUrl)?this.showAllUpdates&&this.showAllUpdates.incrementOffset():(this.model.set("show-fewer",!0),b.setDone(),this.showAllUpdates&&this.showAllUpdates.setDone())},this),error:function(){b.log("ajax failed");b.log("error handler has not been implemented yet")},complete:function(){a.set("fetching",!1)}})},setDone:function(){this.url=null;this.model.set("show-fewer",!0)},toggleShowFewer:function(){var a=this.model;a.set("show-fewer",!a.get("show-fewer"))}}})})();
(function(){var d=LIModules.requires("jquery"),e=LIModules.requires("underscore"),c=LIModules.requires("OzFeed");LIModules.requires("OzFeedUpdate").addView({block:"show-previous-comments",sync:!0,events:{click:function(a){this.url&&(d(a.target).hasClass("action")&&!this.model.get("fetching"))&&(c.log("fetch more comments"),this._fetchMoreComments())}},methods:{init:function(){var a=this.$el,b=this.model;this.$action=a.find(".action");this.url=this.$action.data("url");this.$loader=d('\x3cspan class\x3d"loading hidden"/\x3e');
a.append(this.$loader);b.set("done",!1);b.set("fetching",!1);b.set("offset",this.url?+play.getUrlParameter(this.url,"offset"):0);b.set("insertCount",this.url?+play.getUrlParameter(this.url,"count"):0);b.on("change:fetching",this._toggleFetching,this);b.on("change:offset change:insertCount",this._updateUrl,this);b.on("change:done",this.remove,this)},_toggleFetching:function(){var a=this.$action,b=this.$loader;this.model.get("fetching")?(a.prop("disabled",!0),b.removeClass("hidden")):(a.prop("disabled",
!1),a.focus(),b.addClass("hidden"))},_fetchMoreComments:function(){var a=this.model;a.set("fetching",!0);void 0===this.commentList&&(this.commentList=this.update.getViews("comment-list")[0]||null);this.commentList&&c.Util.ajax({url:this.url,success:e.bind(function(a){c.log("ajax succeeded");this.commentsSocialSummary||(this.commentsSocialSummary=this.update.getViews("comments-social-summary")[0]);this.commentList.insertComments(a);(this.url=a.paginationUrl)?(this.commentsSocialSummary.incrementOffset(this.model.get("insertCount")),
this.model.set("offset",+play.getUrlParameter(this.url,"offset"),{silent:!0})):this.commentsSocialSummary.allCommentsInjected()},this),error:function(){c.log("ajax failed");c.log("error handler has not been implemented yet")},complete:e.bind(function(){a.set("fetching",!1);this.url||a.set("done",!0)},this)})},_updateUrl:function(){var a=this.model;this.url&&(this.url=play.addQueryParameter(this.url,"offset",""+a.get("offset")),this.url=play.addQueryParameter(this.url,"count",""+a.get("insertCount")))},
show:function(){this.$el.show()},remove:function(){this.removeSelf()},incrementOffset:function(a){var b=this.model;b.set("offset",b.get("offset")+(a||1))},decrementOffset:function(a){var b=this.model;a=b.get("offset")-(a||1);b.set("offset",0>a?0:a)}}})})();
(function(){var d=LIModules.requires("jquery"),e=LIModules.requires("underscore");LIModules.requires("OzFeed");var f=LIModules.requires("OzFeedUpdate"),g=LIModules.requires("Events");f.addView({block:"text-entity",events:{click:function(a){d(a.target).closest(".show-more").length?this._expand():d(a.target).closest(".show-less").length&&this._shorten()}},methods:{init:function(){var a=this.$el;this.$text=a.children("p");this.$buttons=a.find(".show-more, .show-less");this.$showMore=a.find(".show-more");
this.$showLess=a.find(".show-less")},_triggerEvent:function(){e.delay(g.trigger,10,"ozfeed-text-entity-render")},_expand:function(){var a=this.$el,b=this.$text,c=this.$buttons;c.detach();b.html(a.data("full-text"));b.append(c);a.removeClass("shortened");a.addClass("expanded");this.$showLess.focus();this._triggerEvent()},_shorten:function(){var a=this.$el,b=this.$text,c=this.$buttons;c.detach();a.addClass("shortened");a.removeClass("expanded");b.html(a.data("truncated-text"));b.append(c);this.$showMore.focus();
this._triggerEvent()},getContents:function(){return this.$el.data("full-text")||this.$text.text()}}})})();
(function(){var b=LIModules.requires("jquery"),d=LIModules.requires("underscore"),e=LIModules.requires("Dropdown"),f=LIModules.requires("Events"),g=LIModules.requires("OzFeed");b(function(){d.defer(function(){function c(a){a.updateActionsDropdown=new e(a.find(".update-actions"),{triggerSelector:".trigger",eventType:"hover",focusClass:"focused"});a.mouseleave(a.updateActionsDropdown.close)}b(".feed-update").each(function(){c(b(this))});f.on(g.OZFEED_NEW_UPDATES_EVENT,function(a){a.newUpdates.each(function(){c(b(this))})})})})})();
(function(){var d=LIModules.requires("jquery"),e=LIModules.requires("underscore"),f=LIModules.requires("OzFeed"),g={collapsed:"ozfeed-templates/blocks/rich-media/video",expanded:"ozfeed-templates/partials/_embedly"};LIModules.requires("OzFeedUpdate").addView({block:"video",events:{click:function(a){var b=d(a.target);f.Util.embed.isEmbeddable(this.url)&&(a.preventDefault(),b.parents("a").length||b.is("a"))&&(b.is(".close")?this.model.set("state","collapsed"):this.model.get("fetching")||this._embedly(this.url,
e.bind(function(){this.model.set("state","expanded")},this),e.bind(function(){f.log("error handler has not been implemented yet")},this)))}},methods:{init:function(){var a=this.model,b=this.$el.find(".image");this.$loader=d('\x3cspan class\x3d"loading hidden"/\x3e');this.url=b.attr("href");b.append(this.$loader);a.set("state","collapsed");a.set("fetching",!1);a.on("change:state",this.render,this);a.on("change:fetching",this._toggleFetching,this)},render:function(){var a=this.$el,b=this.model.get("state");
a.css("height",this.embedlyCache.height);dust.render(g[b],this.embedlyCache,function(b,c){a.html(c);a.css("height",a.find(".embedly").height())});a.addClass("video-"+b)},_toggleFetching:function(){this.$loader.toggleClass("hidden",!this.model.get("fetching"))},_embedly:function(a,b,d){var c=this.model;c.set("fetching",!0);this.embedlyCache?(b(this.embedlyCache),c.set("fetching",!1)):(c.set("fetching",!0),f.Util.embed.withEmbedly(this.url,this.$el.width()).done(e.bind(function(a){this.embedlyCache=
a;b(a)},this)).fail(d).always(function(){c.set("fetching",!1)}))}}})})();
(function(){function h(a,b){var e=l(a.elem).closest('[data-block\x3d"video-embedded"]'),f=e.find(m);f.add(f.closest(".embedly")).attr({tabindex:b?"-1":"0"});return e.toggleClass(v,b)}function r(a,b){a.neverAutoPlay||a.isPlaying||(h(a,!1),a._tracking.reason=b,a.play())}function n(a,b){a.isPlaying&&(h(a,!0),a.isAutoPaused=!0,a._tracking.reason=b,a.pause())}function s(a){return!a||a.neverAutoPlay||!a.isAutoPaused&&!a.isPlaying}function p(a){f.each(d,function(b){b!==a&&n(b,g.VIDEO_PRIORITY_CHANGED)})}
var l=LIModules.requires("jquery"),f=LIModules.requires("underscore"),q=LIModules.requires("OzFeed");LIModules.requires("Events");var w=LIModules.requires("OzFeedUpdate"),x=LIModules.requires("OzFeedTrackingRouter"),y=LIModules.imports("TrackFailure"),t=LIModules.requires("playerjs"),u=require("PlayerjsTrackingAdaptor"),z=LIModules.imports("getPageKey"),g=u.PLAYER_STATE_CHANGED_REASONS,v="video-paused",m=".embedly-embed",d=[];w.addView({block:"video-embedded",events:{enterviewport:function(a){var b=
this.player;a=0<a.distance;b&&(a?d.push(b):d=[b].concat(d),s(b)||(p(b),r(b,g.ENTERED_VIEWPORT)))},exitviewport:function(){var a=this.player;a&&(n(a,g.EXITED_VIEWPORT),d=f.without(d,a))},scrollviewport:function(a){var b=this.player;a=a.distance;var e;!b||20>=Math.abs(a)||(e=0<a,a=f.reject(d,s),e=e?a.length-1:0,(a=a[e])||(a=f.findWhere(d,{isPlaying:!0})),a===b?r(b,b._tracking.reason!==g.ENTERED_VIEWPORT||b.isPlaying?g.VIDEO_PRIORITY_CHANGED:g.ENTERED_VIEWPORT):n(b,g.VIDEO_PRIORITY_CHANGED))},keyup:function(){this.wasKeyed=
!0;this.lastFocusedElement=document.activeElement},mousedown:function(a){var b=this.$button;l(a.target).closest(b).length&&b.addClass("video-hide-outline")},click:function(a){var b=this.$button;a=l(a.target);var e=this.player;a.closest(b).length&&(b.find(".video-thumbnail").length?this._swapThumbnail(b):e&&(p(e),h(e,!1),e._tracking.reason=g.USER_TRIGGERED,e.play()))}},methods:{init:function(){var a=this.$el.find(m);this.$button=this.$el.find(".video-play-button");this.sessionId=this.$el.data("session-id");
this.videoUrn=this.$el.data("video-urn");a.length&&(this.player=this._initPlayer(a,!0))},destroy:function(){var a=this.player,b=a&&a._tracking;a&&(b&&b.destroy(),f.each(t.EVENTS.all(),function(b){a.off(b)}),d=f.without(d,a))},_initPlayer:function(a,b){var e=this.$button,d=this.$el.find(".video-player"),c=new t.Player(this._initIframe(a).get(0)),k;k=c._tracking=new u.default(c,{appId:"home-play-video-embedded",mediaViewTrackingId:this.sessionId,mediaUrn:this.videoUrn,requestHeader:{pageKey:z()}});
k.onSeeked=f.wrap(k.onSeeked,function(a){this.wasSeeked=!0;a.apply(this,Array.prototype.slice.call(arguments,1))});if(this.update.$el.hasClass(q.HIGHLIGHTED)||d.data("disable-autoplay"))h(c,!0),c.neverAutoPlay=!0;c.on("ready",f.bind(function(){c.supports("method","mute")&&b&&!c.neverAutoPlay?c.mute():c.supports("method","unmute")?c.unmute():c.setVolume(50);c.on("pause",f.bind(function(){k.reason=g.USER_TRIGGERED;c.isPlaying=!1;k.wasSeeked?k.wasSeeked=!1:(h(c,!0),this._wasActivatedViaKeyboard()&&e.focus())},
this));c.on("play",f.bind(function(){k.reason=g.USER_TRIGGERED;h(c,!1);this._wasActivatedViaKeyboard()&&a.focus();p(c);c.isAutoPaused&&d.length&&(c.timeoutForAutoPlayAction=window.setTimeout(function(){x.track(d,d.data("trk"));window.clearTimeout(c.timeoutForAutoPlayAction)},3E3));c.isAutoPaused=!1;c.isPlaying=!0},this));c.on("ended",function(){h(c,!1)})},this));c.isAutoPaused=!0;c.isPlaying=!1;return c},_swapThumbnail:function(a){var b=a.data("href");q.Util.embed.isEmbeddable(b)&&!a.find(".loading").length&&
(this.$loader=l('\x3cspan class\x3d"loading"/\x3e'),q.Util.embed.withEmbedly(b,a.width()).done(f.bind(this._render,this)).fail(f.bind(function(a,b,c){this.$loader.remove();y.logError("Embed.ly response failed","Status: "+b+"\nError thrown: "+c)},this)),a.prepend(this.$loader))},_render:function(a){var b=this.$el,e=this.$button;a.excludeInfo=!0;a.updateId=this.update.id;dust.render("ozfeed-templates/partials/_embedly",a,f.bind(function(a,c){var d=l(c),g=d.find(m);this._initPlayer(g);g.on("load",f.bind(function(){b.addClass("video-loaded");
this.wasKeyed&&d.focus()},this));e.after(d)},this))},_initIframe:function(a){var b="a11y-"+this.update.id,d=l(a.siblings("#"+b));return a.attr({"aria-labelledby":b,title:d.text()})},_wasActivatedViaKeyboard:function(){var a=this.wasKeyed;this.wasKeyed=!1;return a&&this.$el.find(this.lastFocusedElement).length}}})})();
(function(){var c=LIModules.requires("underscore"),b=LIModules.requires("OzFeed");LIModules.requires("OzFeedUpdate").addView({block:"wrong-entity",events:{click:function(){b.log("clicked on wrong entity(person or company)");this._promptDialog()}},methods:{_promptDialog:function(){var a=this.$el;this.wrongEntityUrl=a.data("wrong-entity-url");this.wrongEntityName=a.data("wrong-entity-name");this._setupDialog()},_setupDialog:function(){var a={closeOnMaskClick:!0,decorators:["scripts/shared/Dialog/DecisionModalDialog"],
submitSelector:".confirm",submitCallback:c.bind(function(){b.Util.ajax({url:this.wrongEntityUrl,type:"POST"});this.$el.data("dialog").close();this.update.wrongEntity()},this),cancelSelector:".cancel"};b.Util.setupDialog({$el:this.$el,data:{name:this.wrongEntityName},template:"ozfeed-templates/partials/_wrong-entity-dialog",id:"wrong-entity-dialog",titleKey:"i18n_please_confirm",jsConfig:a})}}})})();
(function(){var b=LIModules.requires("underscore"),a=LIModules.requires("OzFeed"),c={"not-endorsed":"endorse",endorsed:"endorsed"};LIModules.requires("OzFeedUpdate").addView({block:"endorse",events:{click:function(){a.log("clicked on endorse action");this._endorse()}},methods:{init:function(){var a=this.model;a.set("state","not-endorsed");a.on("change:state",this.render,this)},render:function(){dust.render("ozfeed-templates/blocks/actions/endorse/"+c[this.model.get("state")],{},b.bind(function(a,
d){this.$el.replaceWith(d);this.model.off("change:state")},this))},_endorse:function(){var b=this.update.getViews("recommendation-entity",{ancestor:"recommendation-entity",$context:this.$el,firstBlock:!1})[0],d=this.$el.data("endorse-url"),c=this.$el.data("signature");a.Util.ajax({url:d,data:{csrfToken:a.Util.getCsrfToken(),signature:c},success:function(){a.log("ajax call succeeded")},error:function(){a.log("ajax failed")}});this.model.set("state","endorsed");this.recommendationsEndorse||(this.recommendationsEndorse=
this.update.getViews("recommendations-endorse")[0],this.recommendationsEndorse.incrementEndorsedCount());b.remove()}}})})();
(function(){function l(a,c){var d;"string"!==typeof h&&(h=a.closest(s).data("impression-url"));d=h;c.signatures.length&&(b.Util.ajax({url:d,data:{csrfToken:b.Util.getCsrfToken(),signatures:c.signatures},success:function(){b.log("impression ajax succeeded")},error:function(){b.log("impression ajax failed")}}),0<k&&t(c),k++,b.Util.ajax({type:"GET",url:m,data:{crsfToken:b.Util.getCsrfToken(),pageNumber:k},success:function(a){b.log("module key ajax succeeded");g.attr(u,a)},error:function(){b.log("module key ajax failed")}}))}
function t(a){a=a.entities;var c=a.length,d;for(d=0;d<c;d++)a[d].attr(v,"");g.length&&w.fireImpressionEvents(g)}function n(a){var c={signatures:[],entities:[]};e.each(a,function(a){a=f(a);a.data(p)||(c.signatures.push(a.data("signature")),c.entities.push(a),a.data(p,!0))});return c}var f=LIModules.requires("jquery"),e=LIModules.requires("underscore"),b=LIModules.requires("OzFeed"),x=LIModules.requires("OzFeedUpdate"),w=LIModules.requires("UserActivityTrackingInstance"),q,r=0,k=0,s=".recommendations",
v="data-li-utrk-impr",p="impressioned",u="data-li-utrk-module",h,m,g;x.addView({block:"recommendations-endorse",methods:{init:function(){var a=this.model;this.$list=f(this.$el.children("ul")[0]);this.fetchUrl=this.$el.data("fetch-url");this.randomSeed=this.$el.data("random-seed");this.numVisibleRecommendations=3;this.lixEndorsementsRedesign="enabled"===this.$el.data("lix-endorsements-redesign");a.set("recommendationsList",[]);a.set("pendingRecommendations",{});a.set("endorsedCount",0);this._resetList();
a.on("change:recommendationsList",e.debounce(e.bind(this._fireImpressionEvent,this),500));a.on("change:pendingRecommendations",this.render,this)},render:function(){var a=this.model.get("pendingRecommendations");a.endorsements&&a.endorsements.length&&dust.render(this.lixEndorsementsRedesign?"ozfeed-templates/promo/endorsements/endorsements_redesign":"ozfeed-templates/promo/endorsements/endorsements",a,e.bind(function(a,d){if(null===a){var b=f("\x3cdiv/\x3e").html(d).find(".recommendation-entity");
this.$list.append(b);this.update.initView(b.find("button[data-block]").addBack());this._resetBuffer()}},this))},_resetBuffer:function(){this.model.set("pendingRecommendations",{},{silent:!0})},_resetList:function(){this.resetList(!0)},_fireImpressionEvent:function(){var a=this.model.get("recommendationsList").slice(0,3),c=n(a);l(a,c);this._addRecommendations()},_addRecommendations:function(){q=LIModules.requires("addParams");this.fetchUrl&&12>=this.model.get("recommendationsList").length&&b.Util.ajax({url:q(this.fetchUrl,
{offset:r+=20,count:20,randomizationSeed:this.randomSeed}),success:e.bind(function(a){b.log("ajax call to add more endorsement recommendations succeeded");this.model.set("pendingRecommendations",a);this._resetList()},this),error:function(){b.log("ajax to add more endorsement recommendations failed")},complete:e.bind(this._checkEndStateReached,this)})},_checkEndStateReached:function(){this.getList()&&this.getList().length||(this.model.get("endorsedCount")?dust.render("ozfeed-templates/promo/endorsements/endorsements_complete",
{numEndorsed:this.model.get("endorsedCount")},e.bind(function(a,c){if(null===a){var d=this.$el.parent(),b=d.find(".headline"),e=f(c);d.addClass("completed");b.replaceWith(e);this._resetBuffer()}},this)):this.update.dismissSelf())},getList:function(){return this.model.get("recommendationsList")},resetList:function(a){this.model.set("recommendationsList",this.$el.find(".recommendation-entity"),{silent:a})},resetVisibleRecommendations:function(){var a=this.model.get("recommendationsList"),c=this;a.length||
(a=this.$el.find(".recommendation-entity"),this._resetList());3<a.length&&e.each(a.slice(0,3),function(a){c.update.getViews("recommendation-entity",{ancestor:"recommendation-entity",$context:f(a),firstBlock:!1})[0].remove()})},incrementEndorsedCount:function(){var a=this.model;a.set("endorsedCount",a.get("endorsedCount")+1)}}});f(function(){var a=f('[data-block\x3d"recommendations-endorse"]');g=a.closest("[data-block\x3dlego]");m=g.attr("data-module-key-url");a.each(function(){var a=f(this).find(".recommendation-entity").slice(0,
3),b=n(a);l(a,b)})})})();
(function(){var a=LIModules.requires("jquery"),g=LIModules.requires("Events"),e=LIModules.requires("OzFeed"),b,h="data-li-lego-trk-status",k="fired";a(function(){function f(){b&&a('[data-block\x3d"lego"]').each(function(f,e){var c=a(e),d=c.closest(".updates.promo"),m=d.next(".updates.feed"),l=b.getTrackingData(c).token;if(c.attr(h)!==k){b.fireImpressionEvent([l]);b.installClickHandler(c);if(d.length)g.on("ozfeed-newUpdates",function(c,a){d.find(".switching-filters.overlay").remove();"top"===a?(d.insertBefore(m),
b.fireImpressionEvent([l])):"recent"===a&&(d=d.detach())});c.attr(h,k)}})}b=LIModules.imports("PlayLego");f();g.on(e.OZFEED_NEW_UPDATES_EVENT,f)})})();
LI.PlayLego=function(e,n){function p(a){l=g(a,"/tracking/actions");m=g(a,"/tracking/impressions");q=g(a,"/cooloff/widgetToken");r=g(a,"/cooloff/group")}function g(a,b){var c=n.getPageContext();if(c&&a&&1<a.length){var c=e.param({csrfToken:c.csrfToken}),d;d="/"==a.substr(-1)?a.substr(0,a.length-1):a;return d+b+"?"+c}}function s(a){if(a)return a+"\x26sync\x3dtrue"}function f(a){return"[data-"+a+"]"}function h(a,b){var c=JSON.stringify(b);e.ajax({type:"POST",contentType:"application/json; charset\x3dutf-8",
url:a,data:c,dataType:"json"})}var l,m,q,r;p(n.getPageContext().contextPath);return{init:function(a){a=a||{};a.baseUrl&&p(a.baseUrl)},getTrackingData:function(a){var b,c,d,k,t,e;b=a.closest(f("li-lego-trk-token"));b.length&&(c=b.data("li-lego-trk-token"));a=a.closest(f("li-lego-action"));a.length&&(d=a.data("li-lego-action"),k=a.data("li-lego-action-name"),t=a.data("li-lego-action-count"),e=a.data("li-lego-sync"));return{token:c,actionCategory:d,actionName:k,actionCount:t,sync:e}},setTrackingData:function(a,
b){var c;b.token&&(c=a.closest(f("li-lego-trk-token")),c.length&&c.data("li-lego-trk-token",b.token));if(b.actionCategory||b.actionName||b.actionCount)c=a.closest(f("li-lego-action")),c.length&&(c.data("li-lego-action",b.actionCategory),c.data("li-lego-action-name",b.actionName),c.data("li-lego-action-count",b.actionCount),c.data("li-lego-sync",b.sync))},installClickHandler:function(a){var b=this,c=a.closest(f("li-lego-trk-token")).data("li-lego-trk-token");a.on("click contextmenu",function(a){a=
e(a.target);a=b.getTrackingData(a);b.fireActionEvent(c,a.actionCategory,a.actionName,a.actionCount,a.sync)})},fireActionEvent:function(a,b,c,d,k){var e=l;l&&(a&&b)&&(a={trackingToken:a,actionCategory:b,actionName:c||"default",actionCount:d||1},!0===k&&(e=s(e)),h(e,a))},fireImpressionEvent:function(a,b){var c=m,d;d=e.grep(a,function(a,b){return a});m&&d.length&&(d=e.map(d,function(a,b){return{trackingToken:a,visibility:"SHOW"}}),d={widgetsImpressionInfo:d},!0===b&&(c=s(c)),h(c,d))},coolOffWidget:function(a,
b){h(q,{trackingToken:a,cooloffPeriod:b})},coolOffWidgetForever:function(a){this.coolOffWidget(a,"time\x3e\x3d999y")},coolOffGroup:function(a,b,c,d,e){h(r,{pageId:a,layoutId:b,slotId:c,groupId:d,cooloffPeriod:e})}}}(window.jQuery||window.Zepto,window.play);
(function(){var a=LIModules.requires("jquery");a(function(){a(".star-update").addClass("seen")})})();
/* Auto generated, hash = 4wp9nl3d1uwucbyqbh7ghaufa */
(function(a){var b=a.requires("jquery"),k=a.requires("underscore"),l=a.requires("Events"),m=a.requires("OzFeed"),d,f,c,g,h=function(a){f=this;this._$el=a;this.counts=this.counts||[];this.widths=this.widths||[];c=this._$el.find(".meter");g=c.find(".highlighter");this.initialize=function(){this.createCounts();this.createWidths();this.applyProgressInMeter()};this.createCounts=function(){c.each(function(){f.counts.push(b(this).data("count"))})};this.createWidths=function(){var a=k.max(f.counts),b=parseInt(100*
a/84,10),d=this.counts.length,c,e;for(e=0;e<d;e++)c=this.counts[e]===a?399:parseInt(475*(this.counts[e]/b),10),this.widths.push(c)};this.applyProgressInMeter=function(){g.each(function(a){b(this).css("width",f.widths[a])})};this.initialize()};d=function(){b(".bar-chart-container").each(function(){a.exports("OzFeedCharts",new h(b(this)))})};b(function(){d();l.on(m.OZFEED_NEW_UPDATES_EVENT,d)});a.exports("OzFeedCharts",h)})(window.LIModules);
(function(){var a=LIModules.requires("ModalDialogBox");LIModules.requires("jquery");a=a.extend(function(a){return{setDialogBodyContent:function(){this._$dialog.attr("data-li-utrk-ref",this._config.trkRef);this._$dialog.find(".dialog-close").attr("data-li-auto-click-utrki","u\x3dDismissCTA\x26n\x3ddismissLikers\x26y\x3dDISMISS");a.setDialogBodyContent.apply(this,arguments);LIModules.requires("LikersModalActions").init()}}});LIModules.exports("LikersModalDialogBox",a)})();(function(){LIModules.requires("jquery")(function(){var c=LIModules.requires("Events"),f=LIModules.requires("LikersModalDialogBox"),d=LIModules.requires("t8");c.on("click-show-likes",function(a){var b=a.$el.closest("button");a=b.data("likersDialog");b.data("href")&&!a&&(a=new d.Resources(dust.i18n,dust),a.get("show_likes_likers_dialog","likers-modal-templates/likers_modal",{},function(a,c){if(a)throw a;var d={title:c,decorators:["scripts/shared/Dialog/AjaxDustLoading"],customClassName:"likers-modal",
top:75,centerVertically:!0,dustContentTemplate:"likers-modal-templates/likers_modal",trkRef:"[data-update-id\x3d"+b.closest("[data-update-id]").data("update-id")+"]"},e=new f(b,d);e.isReady.done(function(){e.open()});b.data("likersDialog",e)}))})})})();(function(){var d=LIModules.requires("jquery"),t=LIModules.requires("underscore"),m=LIModules.requires("parseQueryString"),u=LIModules.requires("addParams"),b,v=45,n,k,p,w="loader",x="hide",f="href",y="likers-modal-templates/likers_list",c,z="offset",q,r,g,e,l=function(){function l(a){a&&(b&&k)&&(a=g-e.scrollTop()-q,a<=v&&g>=r&&A())}function A(){var a=c.attr(f);a&&b&&(b=!1,h(),d.ajax({type:"GET",url:a,beforeSend:function(a){a.setRequestHeader("X-IsAJAXForm",1)},success:function(a,c){a.likers.length?
dust.render(y,a,function(a,c){a||(d(c).insertBefore(d(".show-more-container")),s(),b=!0);h()}):(b=!0,k=!1,h())},failure:function(a){b=!0;h()}}))}function h(){c.toggleClass(w);c.toggleClass(x)}function s(){var a=c.attr(f),b;a&&(b=m(c.attr(f)),b=parseInt(b[z],10)+p,a=u(a,{offset:b},!1),c.attr(f,a))}return{init:function(){var a;k=b=!0;n=d("#all-likers-list");a=d(".dialog-body");e=a.length?a:d("#likers-dialog");c=n.find("#show-more-likers");g=e.prop("scrollHeight");r=parseInt(e.outerHeight(!0),10)||g;
q=e.height();e.on("scroll",t.throttle(l,50));c.length&&(a=m(c.attr(f)),p=parseInt(a.count,10),s())}}}();LIModules.exports("LikersModalActions",l)})();(function(){function t(){var a=this.currentUnit.find(this.connectionSelector);a.on("submit",a.find("form"),function(a){a.preventDefault()}).on("click",this.submitSelector,b.bind(u,this)).on("focus",this.emailInputSelector,b.bind(v,this)).on("click",this.cancelButtonSelector,b.bind(w,this));new x(a.find(this.infoButtonSelector),this.toolTipConfig)}function y(a,d){dust.render(this.template,a,b.bind(function(a,b){var e=g(b);this.currentUnit.append(e).addClass(this.unitMarkerClass);d.call(this,e)},this))}
function h(){var a=this.currentUnit,b=a.find(this.connectionSelector),c=a.find(this.previousContentSelector);a.toggleClass(this.displayClass);m.fire(z+this.eventNamespace,a.is(this.displayClass)?b:c)}function w(a){this.currentUnit=g(a.target).parents(this.unitSelector);h.call(this);this.reset()}function v(a){this.currentUnit=g(a.target).parents(this.unitSelector);this.reset()}function u(a){var d=g(a.target),c,f,e;a.preventDefault();this.currentUnit=d.parents(this.unitSelector);c=this.currentUnit.find(this.submitSelector);
f=this.currentUnit.find(this.connectionSelector+" "+this.titleWrapSelector);a=this.currentUnit.find(this.emailInputSelector);e=a.val();this.reset();A.email.test(e)?(d.addClass(n).attr(k,k),p.ajax({url:c.data("connect-url")+"\x26email\x3d"+encodeURIComponent(e),type:"POST",success:b.bind(function(a){"success"===a.status?m.fire(B+this.eventNamespace,c):(this.reset(),f.addClass(l))},this),error:b.bind(function(){this.reset();f.addClass(l)},this)})):(f.addClass(q),a.addClass(r))}var g=LIModules.requires("jquery"),
b=LIModules.requires("underscore"),m=LIModules.requires("Events"),x=LIModules.requires("OzTooltip"),A=LIModules.requires("patterns"),p,C={template:"common-templates/authenticate-connect",eventNamespace:"props",unitSelector:".card",connectionSelector:".authenticate-connect",submitSelector:".authenticate-connect-connect",previousContentSelector:".front",emailInputSelector:"input.email",cancelButtonSelector:".authenticate-connect-cancel",infoButtonSelector:".info",titleWrapSelector:".titlewrap",unitMarkerClass:"requires-email-authentication",
displayClass:"show-authenticate-connect",toolTipConfig:{direction:"left",type:"hovercard",tooltipContentID:"authenticate-connect-tooltip"}},k="disabled",r="error",q="show-email-error",l="show-generic-error",n="submitting",D=l+" "+q,B="authenticate-connect-success.",z="authenticate-connect-toggle.",s=function(a){p=LIModules.requires("OzHelpers");b.extend(this,C,a);this.eventNamespace=this.eventNamespace.replace(/^\./,"")};s.prototype={reset:function(){var a=this.currentUnit.find(this.connectionSelector);
a.find(this.titleWrapSelector).removeClass(D);a.find(this.submitSelector).removeClass(n).removeAttr(k);a.find(this.emailInputSelector).removeClass(r)},show:function(a,d){function c(){t.call(this);b.defer(b.bind(h,this))}this.currentUnit=a.parents(this.unitSelector);this.currentUnit.find(this.connectionSelector).length?h.call(this):y.call(this,d,c)}};LIModules.exports("AuthenticateConnect",s)})();(function(){var d=LIModules.requires("jquery"),b=LIModules.requires("underscore"),c=LIModules.requires("Events"),p=LIModules.requires("AuthenticateConnect"),k=LIModules.requires("readCookie"),l=LIModules.requires("createCookie"),e,q=200,m=function(a){e=LIModules.requires("OzHelpers");this.$el=a;this.stateCookieName="oz_props_fetch_size1_"+a.data("member-id");this.authenticateConnect=new p;this._initializeStateCookie();this._bindEvents()};m.prototype={_bindEvents:function(){this.$el.on("click","button.comment",
b.bind(function(a){this.handleCommentClicked(d(a.target))},this)).on("click","button.like",b.bind(function(a){this.handleLikeClicked(d(a.target))},this)).on("click","button.skip",b.bind(function(a){this.handleSkipClicked(d(a.target))},this)).on("click","button.peek",b.bind(this.handlePeekClicked,this)).on("click",".front button.connect",b.bind(function(a){this.handleConnectClicked(d(a.target))},this)).on("mouseup","button",b.bind(function(a){this.handleButtonMouseup(d(a.target))},this));c.on("authenticate-connect-toggle.props",
b.bind(this.handleAuthenticateToggle,this)).on("authenticate-connect-success.props",b.bind(this.handleAuthenticateSuccess,this))},_bindCommentEvents:function(a){a.on("click","button.cancel",b.bind(this.handleCommentCancelClicked,this)).on("click","button.comment-submit",b.bind(this.handleCommentSubmitClicked,this))},_setTabIndexTo:function(a){this.$el.find(".card.current").find("button, a").attr("tabindex","-1");a.find("button, a").removeAttr("tabindex")},_showToast:function(a,b){dust.render("props-templates/shifted/overlays/"+
b+"-toast",{},function(b,c){var g=d(c);a.closest(".card").append(g);setTimeout(function(){g.addClass("show")},20)})},_initializeStateCookie:function(){null===k(this.stateCookieName)&&l(this.stateCookieName,this.$el.data("count"),0.125)},_decrementStateCookie:function(){l(this.stateCookieName,(parseInt(k(this.stateCookieName),10)||1)-1,0.125)},handleAuthenticateToggle:function(a){this._setTabIndexTo(a)},handleAuthenticateSuccess:function(a){this.handleConnectSuccess(a)},handleButtonMouseup:function(a){a.blur()},
handleCommentCancelClicked:function(a){a.preventDefault();d(a.target).parents(".card").removeClass("show-comment-box");this._setTabIndexTo(this.$el.find(".card.current"))},handleCommentClicked:function(a){function g(){setTimeout(function(){f.find("textarea").focus().get(0).setSelectionRange(e,e)},2*q)}var c=a.data("comment"),e=c.length,h=a.closest(".card"),f=h.find(".comment-box");f.length?(h.addClass("show-comment-box"),g()):dust.render("props-templates/shifted/overlays/comment-box",{comment:c,url:a.data("url"),
params:a.data("params"),clickTrks:a.data("comment-overlay-trks"),isMentionsEnabled:this.$el.data("props-mentions")},b.bind(function(a,b){f=d(b);h.append(f);this._bindCommentEvents(f);this._setTabIndexTo(f);setTimeout(function(){h.addClass("show-comment-box")},20);g()},this))},handleCommentSubmitClicked:function(a){var b=d(a.target).parents(".comment-box"),n=b.data("params");a.preventDefault();n.message=b.find("[name\x3dcomment]").val();e.ajax({url:b.data("url"),data:n});setTimeout(function(){c.fire("next.props")},
900);this._showToast(b,"commented");this._decrementStateCookie();return!1},handleConnectClicked:function(a){var c=a.parents(".card"),d={name:a.data("first-name"),url:a.data("connect-url")};c.find(".authenticate-connect").length?this.authenticateConnect.show(a,d):(a.addClass("submitting").attr("disabled","disabled"),e.ajax({url:d.url,type:"POST",success:b.bind(function(b){"success"===b.status?this.handleConnectSuccess(a):this.authenticateConnect.show(a,d)},this),complete:function(){a.removeClass("submitting").removeAttr("disabled")}}))},
handleConnectSuccess:function(a){this._showToast(a,"invitation-sent");c.fire("pymk-request.props",a.data("fetch-url"));setTimeout(function(){c.fire("next.props")},900)},handleLikeClicked:function(a){this._showToast(a,"liked");e.ajax({url:a.data("like-url")});setTimeout(function(){c.fire("next.props")},900);this._decrementStateCookie()},handlePeekClicked:function(){var a=this.$el.find(".card.current");a.hasClass("pymk")&&c.fire("pymk-request.props",a.find("button.skip").data("skip-url"));c.fire("next.props")},
handleSkipClicked:function(a){a.closest(".pymk").length?c.fire("pymk-request.props",a.data("skip-url")):(e.ajax({type:"POST",url:a.data("skip-url")}),this._decrementStateCookie());c.fire("next.props")}};LIModules.exports("PropsCard",m)})();(function(){var d=LIModules.requires("jquery"),c=LIModules.requires("underscore"),g=LIModules.requires("Events"),n=LIModules.requires("Mentions"),p=LIModules.requires("PropsCard"),e=LIModules.imports("TrackFailure"),l=LIModules.imports("ViewportTracking"),q=LIModules.requires("MultilineTruncation"),m,h,k=function(a){this.$el=a;this.allCaughtUpTimeout;this.pymkQueryOffset=0;this.pymkUrl="";this.pymkRequestQueue=[];this.pymkPeopleRemain=!0;this.pymkDustPath=a.data("pymk-connect-inline")?"props-templates/shifted/cards/pymk-connect-inline":
"props-templates/shifted/cards/pymk";this._setTabIndex();this._bindEvents();this._truncate(a.find(".card.current"));this.$el.data("props-mentions")&&this._bindMentions(this.$el);new p(a)};k.prototype={handleNext:function(){var a=this.$el.find(".card.current"),b=this.$el.find(".card:not(.current):not(.dismissed):first");a.addClass("dismissed");setTimeout(c.bind(function(){this._truncate(b);a.removeClass("current").hide()},this),200);b.length?(b.addClass("current"),setTimeout(function(){b.attr("data-li-utrk-impr",
"");m.fireImpressionEvents();l&&l.trackPropsImpressions({fullRefresh:!0})},200),g.fire("update-impression.props")):this._tryDismiss();this._setTabIndex();clearTimeout(this.allCaughtUpTimeout);b.hasClass("all-caught-up")&&(this.initializePymk(),this.allCaughtUpTimeout=setTimeout(c.bind(function(){this.handleNext()},this),1500))},initializePymk:function(){this.$el.attr("data-li-utrk-module",this.$el.attr("data-li-utrk-pymk-module"));h.ajax({url:this.$el.data("pymk-url"),success:c.bind(function(a){this.pymkQueryOffset=
a.nextQueryOffset;this.pymkUrl=a.url.contactsPymkTitle;this.pymkPeopleToCards(a.people)},this),error:c.bind(function(a,b,f){e&&("timeout"===b?e.logError("propsModulePymkInitialTimeout","Props module PYMK AJAX request timed out for initial fetch."):"error"===b&&e.logError("propsModulePymkInitialException","Props module PYMK AJAX error for initial fetch. Status code: "+a.status+" "+a.statusText+". Error message: "+f+"."));this.pymkPeopleRemain=!1;this._tryDismiss()},this)})},pymkRequestQueuePush:function(a){this.pymkRequestQueue.push(a);
1===this.pymkRequestQueue.length&&this.pymkRequestQueuePop()},pymkRequestQueuePop:function(){var a=this.pymkRequestQueue[0];a&&h.ajax({url:a+"\x26offset\x3d"+this.pymkQueryOffset,success:c.bind(function(a){this.pymkQueryOffset=a.nextQueryOffset;this.pymkPeopleToCards(a.people);this.pymkRequestQueue.shift();this.pymkRequestQueuePop()},this),error:c.bind(function(a,f,c){e&&("timeout"===f?e.logError("propsModulePymkSecondaryTimeout","Props module PYMK AJAX request timed out for secondary fetch."):"error"===
f&&e.logError("propsModulePymkSecondaryException","Props module PYMK AJAX error for secondary fetch. Status code: "+a.status+" "+a.statusText+". Error message: "+c+"."));this.pymkPeopleRemain=!1;this._tryDismiss()},this)})},pymkPeopleToCards:function(a){a.length?this.pymkPeopleRemain=!0:(this.pymkPeopleRemain=!1,this._tryDismiss());for(var b=0;b<a.length;b++)a[b].url.contactsPymkTitle=this.pymkUrl,dust.render(this.pymkDustPath,a[b],c.bind(function(a,b){this.addCard(b)},this))},addCard:function(a){var b=
this.$el.find(".card.current"),c=d(a);b.length?(c.addClass("hidden"),setTimeout(function(){c.removeClass("hidden")},10)):c.addClass("current");this.$el.append(c);this._setTabIndex()},_setTabIndex:function(){this.$el.find("a, button").attr("tabindex","-1");this.$el.find(".card.current").find("a, button:not(.peek)").removeAttr("tabindex");this.$el.find(".card:not(.current):not(.dismissed):first").find(".peek").removeAttr("tabindex")},_tryDismiss:function(){this.$el.find(".card:not(.dismissed)").length||
this.pymkPeopleRemain||this.$el.addClass("dismissed")},_bindEvents:function(){g.on("next.props",c.bind(this.handleNext,this));g.on("pymk-request.props",c.bind(function(a){this.pymkRequestQueuePush(a)},this))},_bindMentions:function(a){var b=d("#ozfeed").data("oon-mentions");this.mentions=new n.Delegator(a,{oonMentions:b,mentionsTL:"common-templates/mentions-play"})},_truncate:function(a){a.find(".four-lines, .two-lines").filter(function(){return!d(this).find(".four-lines, .two-lines").length}).each(function(){q.truncate(this,
this.getAttribute("data-multiline-truncation-overflow-string")||"")})}};d(function(){m=LIModules.requires("UserActivityTrackingInstance");h=LIModules.requires("OzHelpers");new k(d("#props"))});(function(){d(window).on("load",function(){d("img[data-delayed-url]").each(function(){var a=d(this);a.attr("src",a.attr("data-delayed-url"));a.removeAttr("data-delayed-url")})})})();LIModules.exports("Props",k)})();(function(){var a=LIModules.requires("jquery");a(function(){var h=LIModules.requires("ModalDialogBox"),b=LIModules.requires("Dropdown"),e=LIModules.requires("UserActivityTrackingInstance"),c=a("#footer-feedback"),f=a("#privacy-nav"),g;a("#footer").remove();c.on("click",function(a){a.preventDefault();c.data("dialog")||(g=new t8.Resources(dust.i18n,dust),g.get("i18n_send_feedback","footer-templates/footer",{},function(a,b){var d=new h(c,{decorators:["scripts/shared/Dialog/AjaxLoading"],title:b,width:500,
fitToWindow:!1});d.isReady.done(function(){d.open()});c.data("dialog",d)}))});new b(f,{eventType:"hover",triggerSelector:".subnav-trigger"});f.on(b.EVENTS.OPEN,function(){e.triggerClickTracking("u\x3dprivacyTermsLink\x26n\x3dexpandPrivacyTerms\x26y\x3dEXPAND",e.getImpressionElement(a(this)))})})})();(function(){LIModules.exports("OzScriptLoader",function(b,c){return $.when.apply({},$.map(b,function(b){var c=document.getElementsByTagName("head")[0],a=document.createElement("script"),d=new $.Deferred;a.type="text/javascript";a.async=!0;a.src=play.assetUrl(b);a.addEventListener("load",function(a){d.resolve(a)},!1);c.appendChild(a);return d.promise()})).done(c)})})();(function(){var a=LIModules.requires("jquery");a(function(){a("#internal-feedback").length&&LIModules.requires("OzScriptLoader")(["footer-js/html2canvas.js","footer-js/internalFeedback.js"],function(){LIModules.requires("InternalFeedback").init()})})})();